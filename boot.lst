0001   0000             	MODULE 	boot
0002   0000             	DEVICE 	ZXSPECTRUM48
0003   0000             	OUTPUT	boot.cde
0004   0000             	
0005   0000             ;███████████████ V A R I A B L E S ██████████████████████████████████████		
0006   0000             DMA 		equ #0B
0007   0000             ULA			equ #FE
0008   0000             ;███████████████ M A I N  C O D E ███████████████████████████████████████	
0009   0000             			org 49152		
0010   C000             maincode
0011   C000             			DISP 0
0012   0000 F3          boot		di
0013   0001 31 00 00    			ld sp,0
0014   0004 ED 56       			im 1
0015   0006             ;			ld	a, #C3				; Z80DMA command: WR6: Reset
0016   0006             ;			out	(DMA), a
0017   0006 AF          			xor	a
0018   0007 ED 47       			ld	i, a
0019   0009 D3 FE       			out (ULA),a
0020   000B 21 FF 5A    			ld	hl, 5AFFh
0021   000E 11 FE 5A    			ld	de, 5AFEh
0022   0011 01 FF 1A    			ld	bc, 1AFFh
0023   0014 77          			ld	(hl), a
0024   0015 ED B8       			lddr					; Clear	videoram (black	screen)	
0025   0017 DB FE       			in	a, (254)
0026   0019 2F          			cpl
0027   001A E6 1F       			and	1Fh
0028   001C 20 59       			jr  nz,endramtest		;skip Busy effect
0029   001E 18 1A       			jr boot2
0030   0020             			db "LMN128"
0030   0020 4C4D4E313238
0031   0026             //WARNING max #38 bytes!!!!			
0032   0026 00          endboot		BLOCK #38-endboot,0
0033   0038             ;			DISP #38
0034   0038 FB          im1			ei
0035   0039 C9          			ret					
0036   003A             boot2
0037   003A             	INCLUDE "effect.a80"			; Busy nonbootdisk effect
0001+  003A             ;	DEVICE	ZXSPECTRUM48
0002+  003A             ;	OUTPUT	effect.cod
0003+  003A             ;	org	#8000
0004+  003A             
0005+  003A             ;start	xor	a
0006+  003A             ;	out	(#fe),a
0007+  003A 3E 03       	ld	a,#03
0008+  003C 21 00 40    	ld	hl,#4000
0009+  003F 11 01 40    	ld	de,#4001
0010+  0042 01 00 01    nn1	ld	bc,#0100
0011+  0045 75          	ld	(hl),l
0012+  0046 ED B0       	ldir
0013+  0048 06 06       	ld	b,#06
0014+  004A 36 7E       	ld	(hl),#7e
0015+  004C ED B0       	ldir
0016+  004E 04          	inc	b
0017+  004F 75          	ld	(hl),l
0018+  0050 ED B0       	ldir
0019+  0052 3D          	dec	a
0020+  0053 20 ED       	jr	nz,nn1
0021+  0055 11 00 00    	ld de,0			;LMN start	
0022+  0058 44          nn2	ld	b,h
0023+  0059 4D          	ld	c,l
0024+  005A 29          	add	hl,hl
0025+  005B 29          	add	hl,hl
0026+  005C 29          	add	hl,hl
0027+  005D 09          	add	hl,bc
0028+  005E 01 0C 00    	ld	bc,12
0029+  0061 09          	add	hl,bc
0030+  0062 7C          	ld	a,h
0031+  0063 E6 03       	and	#03
0032+  0065 F6 58       	or	#58
0033+  0067 67          	ld	h,a
0034+  0068 EB          	ex	de,hl
0035+  0069             
0036+  0069 7C          	ld a,h			;LMN
0037+  006A FE 20       	cp 32			;LMN lenght
0038+  006C 28 09       	jr z, end		;LMN
0039+  006E             	
0040+  006E ED A0       	ldi
0041+  0070 EB          	ex	de,hl
0042+  0071 06 1E       	ld	b,#1e		;LMN (was #20) speed
0043+  0073 10 FE       wait	djnz	wait
0044+  0075 18 E1       	jr	nn2
0045+  0077             end
0046+  0077             ;		ret   ; for testing
0047+  0077             ;	OUTEND
0048+  0077             ;	SAVESNA	"effect.sna",start
0049+  0077             
0038   0077             
0039   0077 21 85 00    endramtest	ld hl,ramcodeinrom
0040   007A 11 85 C0    			ld de,ramcode
0041   007D 01 BB 37    			ld bc,endramcode-ramcode
0042   0080 ED B0       			ldir
0043   0082 C3 85 C0    			jp ramcode
0044   0085             
0045   0085             ramcodeinrom	
0046   0085             
0047   0085             			ent						; restore address to compile to right place
0048   C085             ramcode		
0049   C085 F3          			di						; for sna test
0050   C086 31 00 00    			ld sp,0					; for sna test
0051   C089             ; set wifi module to gently power consumption
0052   C089 CD AC CD    			call iinkey.IINKEY
0053   C08C FE 77       			cp "w"
0054   C08E 28 06       			jr z,wfon
0055   C090 FE 57       			cp "W"
0056   C092 28 02       			jr z,wfon
0057   C094 18 45       			jr 2F
0058   C096 08          wfon		ex af,af'
0059   C097 01 3B 20    			ld bc,#203B
0060   C09A 3E 05       			ld a,5
0061   C09C ED 79       			out (c),a
0062   C09E 04          			inc b
0063   C09F ED 78       			in a,(c)			
0064   C0A1 F6 01       			or 1
0065   C0A3 ED 79       			out (c),a				; wifi ON
0066   C0A5 06 03       			ld b,3					; wftimeout	
0067   C0A7 11 00 00    wfloop1		ld de,0							
0068   C0AA 1B          wftimeout	dec de
0069   C0AB 7A          			ld a,d
0070   C0AC B3          			or e
0071   C0AD 20 FB       			jr nz, wftimeout
0072   C0AF 10 F6       			djnz wfloop1
0073   C0B1 08          			ex af,af'
0074   C0B2 FE 57       			cp "W"
0075   C0B4 20 25       			jr nz,2F
0076   C0B6 06 13       			ld b,#13				; wifi ZXi TX port
0077   C0B8 21 CD C0    			ld hl,wifistring
0078   C0BB             
0079   C0BB 7E          1			ld a,(hl)
0080   C0BC ED 79       			out (c),a
0081   C0BE 08          			ex af,af'
0082   C0BF             wfbusy		
0083   C0BF ED 78       			in a,(c)
0084   C0C1 CB 4F       			bit 1,a					
0085   C0C3 20 FA       			jr nz,wfbusy
0086   C0C5 08          			ex af,af'						
0087   C0C6 23          			inc hl
0088   C0C7 FE 0A       			cp 10
0089   C0C9 20 F0       			jr nz,1B
0090   C0CB             	
0091   C0CB             /*			ld b,#21
0092   C0CB~            			in a,(c)			
0093   C0CB~            			and %11111110
0094   C0CB             			out (c),a				; wifi OFF*/
0095   C0CB 18 0E       			jr 2F
0096   C0CD             wifistring  db "AT+RFPOWER=0",13,10
0096   C0CD 41542B5246504F5745523D300D0A
0097   C0DB             
0098   C0DB             2									
0099   C0DB             ; temporary switch to MB02+ machine for testing and NMI enable
0100   C0DB             						
0101   C0DB AF          			xor a
0102   C0DC 01 3B 20    			ld bc,#203B				//ZXi portselect
0103   C0DF ED 79       			out (c),a
0104   C0E1 01 3B 21    			ld bc,#213B
0105   C0E4 3E 01       			ld a,1					//HW - 1 - MB02+
0106   C0E6 ED 79       			out (c),a
0107   C0E8 CD 8F CD    			call cls.CLS
0108   C0EB 3E 07       			ld   a,7
0109   C0ED 21 00 58    			ld   HL,22528
0110   C0F0 11 01 58    			ld   DE,22529
0111   C0F3 01 FF 02    			ld   BC,767
0112   C0F6 77          			ld   (HL),a
0113   C0F7 ED B0       			ldir
0114   C0F9 CD AC CD    				call iinkey.IINKEY		; waiting for key
0115   C0FC C2 BE C2    				jp nz,skipanim
0116   C0FF 3E 00       			ld a,0
0117   C101 32 F1 D7    			ld (txy32.orflag),a
0118   C104 3E 42       			ld a,66
0119   C106 32 3E D7    			ld (txy32.T32_ATT),a
0120   C109 01 00 00    			ld	bc,#0000
0121   C10C CD 0F C2    			call fall1
0122   C10F CD AC CD    				call iinkey.IINKEY		; waiting for key
0123   C112 C2 BE C2    				jp nz,skipanim
0124   C115 3E 46       			ld a,70
0125   C117 32 3E D7    			ld (txy32.T32_ATT),a
0126   C11A 01 10 00    			ld	bc,#0010
0127   C11D CD 0F C2    			call fall1
0128   C120 CD AC CD    				call iinkey.IINKEY		; waiting for key
0129   C123 C2 BE C2    				jp nz,skipanim			
0130   C126 3E 44       			ld a,68
0131   C128 32 3E D7    			ld (txy32.T32_ATT),a
0132   C12B 01 2E 00    			ld	bc,#002E
0133   C12E CD 0F C2    			call fall1
0134   C131 CD AC CD    				call iinkey.IINKEY		; waiting for key
0135   C134 C2 BE C2    				jp nz,skipanim			
0136   C137 3E 45       			ld a,69
0137   C139 32 3E D7    			ld (txy32.T32_ATT),a
0138   C13C 01 59 00    			ld	bc,#0059
0139   C13F CD 0F C2    			call fall1
0140   C142 CD AC CD    				call iinkey.IINKEY		; waiting for key
0141   C145 C2 BE C2    				jp nz,skipanim
0142   C148             				
0143   C148 3E 01       			ld a,1
0144   C14A 32 F1 D7    			ld (txy32.orflag),a
0145   C14D 3E 42       			ld a,66
0146   C14F 32 3E D7    			ld (txy32.T32_ATT),a
0147   C152 01 00 00    			ld	bc,#0000
0148   C155 CD 20 C2    			call fall2
0149   C158 CD AC CD    				call iinkey.IINKEY		; waiting for key
0150   C15B C2 BE C2    				jp nz,skipanim			
0151   C15E 3E 46       			ld a,70
0152   C160 32 3E D7    			ld (txy32.T32_ATT),a
0153   C163 01 10 00    			ld	bc,#0010
0154   C166 CD 20 C2    			call fall2			
0155   C169 CD AC CD    				call iinkey.IINKEY		; waiting for key
0156   C16C C2 BE C2    				jp nz,skipanim			
0157   C16F 3E 44       			ld a,68
0158   C171 32 3E D7    			ld (txy32.T32_ATT),a
0159   C174 01 28 00    			ld	bc,#0028
0160   C177 CD 31 C2    			call fall3
0161   C17A CD AC CD    				call iinkey.IINKEY		; waiting for key
0162   C17D C2 BE C2    				jp nz,skipanim			
0163   C180 3E 45       			ld a,69
0164   C182 32 3E D7    			ld (txy32.T32_ATT),a
0165   C185 01 58 00    			ld	bc,#0058
0166   C188 CD 42 C2    			call fall4
0167   C18B CD AC CD    				call iinkey.IINKEY		; waiting for key
0168   C18E C2 BE C2    				jp nz,skipanim			
0169   C191             			
0170   C191 3E 00       			ld a,0
0171   C193 32 F1 D7    			ld (txy32.orflag),a
0172   C196 3E 45       			ld a,69
0173   C198 32 3E D7    			ld (txy32.T32_ATT),a
0174   C19B 01 57 2A    			ld	bc,#2A57
0175   C19E 11 60 2A    			ld  de,#2A60
0176   C1A1 3E 4B       			ld a,#4B
0177   C1A3 CD CA C1    			call wide1
0178   C1A6 CD AC CD    				call iinkey.IINKEY		; waiting for key
0179   C1A9 C2 BE C2    				jp nz,skipanim			
0180   C1AC 06 01       			ld b,1
0181   C1AE CD 73 CE    			call wait.wait
0182   C1B1 3E 44       			ld a,68
0183   C1B3 32 3E D7    			ld (txy32.T32_ATT),a
0184   C1B6 01 2A 2A    			ld	bc,#2A2A
0185   C1B9 11 35 2A    			ld  de,#2A35
0186   C1BC 3E 1F       			ld a,#1F
0187   C1BE CD CA C1    			call wide1
0188   C1C1 CD AC CD    				call iinkey.IINKEY		; waiting for key
0189   C1C4 C2 BE C2    				jp nz,skipanim			
0190   C1C7             
0191   C1C7             ;			call iinkey.ANYKEY	
0192   C1C7 C3 A0 C2    			jp follow1
0193   C1CA             			
0194   C1CA F5          wide1		push af
0195   C1CB D5          			push de
0196   C1CC C5          			push bc
0197   C1CD ED 43 EB D7 			ld	(txy32.cursor),bc
0198   C1D1 3E 84       			ld a,132
0199   C1D3 CD 3F D7    			call txy32.xy
0200   C1D6 C1          			pop bc
0201   C1D7 C5          			push bc
0202   C1D8 3E 08       			ld a,8
0203   C1DA 80          			add a,b
0204   C1DB 47          			ld b,a
0205   C1DC 3E 86       			ld a,134
0206   C1DE ED 43 EB D7 			ld	(txy32.cursor),bc
0207   C1E2 CD 3F D7    			call txy32.xy
0208   C1E5 C1          			pop bc
0209   C1E6 D1          			pop de
0210   C1E7 C5          			push bc
0211   C1E8 D5          			push de
0212   C1E9 ED 53 EB D7 			ld	(txy32.cursor),de
0213   C1ED 3E 81       			ld a,129
0214   C1EF CD 3F D7    			call txy32.xy
0215   C1F2 D1          			pop de
0216   C1F3 D5          			push de
0217   C1F4 3E 08       			ld a,8
0218   C1F6 82          			add a,d
0219   C1F7 57          			ld d,a
0220   C1F8 ED 53 EB D7 			ld	(txy32.cursor),de
0221   C1FC 3E 83       			ld a,131
0222   C1FE CD 3F D7    			call txy32.xy
0223   C201 06 04       			ld b,4
0224   C203 CD 73 CE    			call wait.wait
0225   C206 D1          			pop de
0226   C207 C1          			pop bc
0227   C208 F1          			pop af
0228   C209 1C          			inc e
0229   C20A 0D          			dec c
0230   C20B B9          			cp c
0231   C20C 20 BC       			jr nz,wide1
0232   C20E C9          			ret
0233   C20F             			
0234   C20F C5          fall1		push bc
0235   C210 CD 7D C2    			call singledot
0236   C213 06 01       			ld b,1
0237   C215 CD 73 CE    			call wait.wait
0238   C218 C1          			pop bc
0239   C219 04          			inc b
0240   C21A 3E 2B       			ld a,#2B
0241   C21C B8          			cp b
0242   C21D 20 F0       			jr nz,fall1
0243   C21F C9          			ret
0244   C220 C5          fall2		push bc
0245   C221 CD 53 C2    			call halfdot
0246   C224 06 01       			ld b,1
0247   C226 CD 73 CE    			call wait.wait
0248   C229 C1          			pop bc
0249   C22A 04          			inc b
0250   C22B 3E 2B       			ld a,#2B
0251   C22D B8          			cp b
0252   C22E 20 F0       			jr nz,fall2
0253   C230 C9          			ret			
0254   C231             	
0255   C231 C5          fall3		push bc
0256   C232 CD 61 C2    			call halfdot3
0257   C235 06 01       			ld b,1
0258   C237 CD 73 CE    			call wait.wait
0259   C23A C1          			pop bc
0260   C23B 04          			inc b
0261   C23C 3E 2B       			ld a,#2B
0262   C23E B8          			cp b
0263   C23F 20 F0       			jr nz,fall3
0264   C241 C9          			ret	
0265   C242             
0266   C242 C5          fall4		push bc
0267   C243 CD 6F C2    			call halfdot4
0268   C246 06 01       			ld b,1
0269   C248 CD 73 CE    			call wait.wait
0270   C24B C1          			pop bc
0271   C24C 04          			inc b
0272   C24D 3E 2B       			ld a,#2B
0273   C24F B8          			cp b
0274   C250 20 F0       			jr nz,fall4
0275   C252 C9          			ret				
0276   C253             	
0277   C253 ED 43 EB D7 halfdot     ld	(txy32.cursor),bc
0278   C257 3E 84       			ld a,132
0279   C259 CD 3F D7    			call txy32.xy
0280   C25C 3E 85       			ld a,133
0281   C25E C3 3F D7    			jp txy32.xy
0282   C261             
0283   C261 ED 43 EB D7 halfdot3    ld	(txy32.cursor),bc
0284   C265 3E 88       			ld a,136
0285   C267 CD 3F D7    			call txy32.xy
0286   C26A 3E 89       			ld a,137
0287   C26C C3 3F D7    			jp txy32.xy	
0288   C26F             
0289   C26F ED 43 EB D7 halfdot4    ld	(txy32.cursor),bc
0290   C273 3E 8A       			ld a,138
0291   C275 CD 3F D7    			call txy32.xy
0292   C278 3E 8B       			ld a,139
0293   C27A C3 3F D7    			jp txy32.xy	
0294   C27D             			
0295   C27D ED 43 EB D7 singledot	ld	(txy32.cursor),bc
0296   C281 3E 84       			ld a,132
0297   C283 C5          			push bc
0298   C284 CD 3F D7    			call txy32.xy
0299   C287 3E 85       			ld a,133
0300   C289 CD 3F D7    			call txy32.xy
0301   C28C C1          			pop	bc
0302   C28D 3E 08       			ld a,8
0303   C28F 80          			add a,b
0304   C290 47          			ld b,a
0305   C291 ED 43 EB D7 			ld	(txy32.cursor),bc	
0306   C295 3E 86       			ld a,134
0307   C297 CD 3F D7    			call txy32.xy
0308   C29A 3E 87       			ld a,135
0309   C29C CD 3F D7    			call txy32.xy
0310   C29F C9          			ret
0311   C2A0             
0312   C2A0 11 0F 05    follow1		ld de,#050F
0313   C2A3 21 FE E3    	        ld hl,ultimatelogo
0314   C2A6 3E 0D       			ld a,13				// number of sprites in animations
0315   C2A8 F5          1			push af
0316   C2A9 D5          			push de
0317   C2AA E5          			push hl
0318   C2AB CD 02 D8    			call sprite2.OK
0319   C2AE 06 0C       			ld b,12
0320   C2B0 CD 73 CE    			call wait.wait
0321   C2B3 E1          			pop hl
0322   C2B4 11 14 00    			ld de,20			// lenght of sprite2
0323   C2B7 19          			add hl,de
0324   C2B8 D1          			pop de
0325   C2B9 1C          			inc e
0326   C2BA F1          			pop af
0327   C2BB 3D          			dec a
0328   C2BC 20 EA       			jr nz,1B
0329   C2BE             /*//Ultimate		
0330   C2BE~            			ld de,#0500
0331   C2BE~            	        ld hl,dots+38*0
0332   C2BE~            			ld a,6				// number of sprites in animations
0333   C2BE~            2			push af
0334   C2BE~            			push de
0335   C2BE~            			push hl
0336   C2BE~            //			call sprite2.OK
0337   C2BE~            			ld b,9
0338   C2BE~            			call wait.wait
0339   C2BE~            			pop hl
0340   C2BE~            			pop de
0341   C2BE~            			inc e
0342   C2BE~            			inc e
0343   C2BE~            			pop af
0344   C2BE~            			dec a
0345   C2BE             			jr nz,2B */
0346   C2BE             skipanim			
0347   C2BE 11 00 00    			ld de,#0000
0348   C2C1 21 1C DC    	    	ld hl,MB03pluslogo
0349   C2C4 CD 02 D8    			call sprite2.OK
0350   C2C7             
0351   C2C7 21 2B F4    			ld hl, STRIPS
0352   C2CA 01 00 48    			ld bc,#4800
0353   C2CD ED 43 EB D7 			ld	(txy32.cursor),bc
0354   C2D1 E5          			push hl
0355   C2D2 CD 25 D7    			call txy32.txy
0356   C2D5 E1          			pop hl
0357   C2D6 01 00 A0    			ld bc,#A000
0358   C2D9 ED 43 EB D7 			ld	(txy32.cursor),bc
0359   C2DD CD 25 D7    			call txy32.txy
0360   C2E0             ;carymary         
0361   C2E0 01 00 48    			 ld bc,#4800
0362   C2E3 11 FF 48    			 ld de,#48ff
0363   C2E6 CD BD CC    			 call draw_jugo.DRAW
0364   C2E9             
0365   C2E9 01 7A 3D    			ld	bc,#3D7A
0366   C2EC ED 43 1F CF 			ld	(txy51.cursor),bc
0367   C2F0 21 57 F3    			ld	hl,TEXT0
0368   C2F3 CD 7B CE    			call txy51.txy
0369   C2F6 01 00 A8    			ld	bc,#A800
0370   C2F9 ED 43 1F CF 			ld	(txy51.cursor),bc
0371   C2FD 21 72 F3    			ld	hl,TEXT4
0372   C300 CD 7B CE    			call txy51.txy			
0373   C303 01 00 B8    			ld	bc,#B800
0374   C306 ED 43 1F CF 			ld	(txy51.cursor),bc
0375   C30A 21 BA F3    			ld	hl,TEXT3
0376   C30D CD 7B CE    			call txy51.txy
0377   C310 01 00 B0    			ld	bc,#B000
0378   C313 ED 43 1F CF 			ld	(txy51.cursor),bc
0379   C317 21 9D F3    			ld	hl,TEXT2
0380   C31A CD 7B CE    			call txy51.txy
0381   C31D 01 DC B0    			ld	bc,#B0DC
0382   C320 ED 43 1F CF 			ld	(txy51.cursor),bc
0383   C324 21 1E F4    			ld	hl,TEXT5
0384   C327 CD 7B CE    			call txy51.txy
0385   C32A 01 B3 9E    			ld	bc,#9EB3
0386   C32D ED 43 1F CF 			ld	(txy51.cursor),bc
0387   C331 21 69 F6    			ld	hl,FW1
0388   C334 CD 7B CE    			call txy51.txy
0389   C337 01 BF 9E    			ld	bc,#9EBF
0390   C33A ED 43 1F CF 			ld	(txy51.cursor),bc
0391   C33E 21 6E F6    			ld	hl,FW2
0392   C341 CD 7B CE    			call txy51.txy
0393   C344 01 D8 9E    			ld	bc,#9ED8
0394   C347 ED 43 1F CF 			ld	(txy51.cursor),bc
0395   C34B 21 35 F8    			ld	hl,DATE
0396   C34E CD 7B CE    			call txy51.txy
0397   C351             			;Core Time Stamp
0398   C351 01 70 9E    			ld	bc,#9E70
0399   C354 ED 43 1F CF 			ld	(txy51.cursor),bc
0400   C358 21 73 F6    			ld	hl,COREFW1
0401   C35B CD 7B CE    			call txy51.txy
0402   C35E 01 87 9E    			ld	bc,#9E87
0403   C361 ED 43 1F CF 			ld	(txy51.cursor),bc
0404   C365 21 78 F6    			ld	hl,COREFW2
0405   C368 CD 7B CE    			call txy51.txy
0406   C36B 01 91 9E    			ld	bc,#9E91
0407   C36E ED 43 1F CF 			ld	(txy51.cursor),bc
0408   C372 01 3B 20    			ld bc,#203B
0409   C375 3E FF       			ld a,#FF
0410   C377 ED 79       			out (c),a
0411   C379 06 27       			ld b,#27
0412   C37B 05          1			dec b
0413   C37C 26 00       			ld h,0
0414   C37E ED 68       			in l,(c)
0415   C380 C5          			push bc
0416   C381 CD F9 CA    			call NUMBER1
0417   C384 C1          			pop bc
0418   C385 78          			ld a,b
0419   C386 FE 24       			cp #24
0420   C388 20 F1       			jr nz, 1B
0421   C38A             
0422   C38A 01 00 50    			ld	bc,#5000
0423   C38D ED 43 1F CF 			ld	(txy51.cursor),bc
0424   C391 21 55 F4    			ld	hl,HW1
0425   C394 CD 7B CE    			call txy51.txy
0426   C397 01 03 58    			ld	bc,#5803
0427   C39A ED 43 1F CF 			ld	(txy51.cursor),bc
0428   C39E 21 66 F4    			ld	hl,HW2
0429   C3A1 CD 7B CE    			call txy51.txy
0430   C3A4 01 03 60    			ld	bc,#6003
0431   C3A7 ED 43 1F CF 			ld	(txy51.cursor),bc
0432   C3AB 21 8F F4    			ld	hl,HW3
0433   C3AE CD 7B CE    			call txy51.txy
0434   C3B1 01 03 68    			ld	bc,#6803
0435   C3B4 ED 43 1F CF 			ld	(txy51.cursor),bc
0436   C3B8 21 A4 F4    			ld	hl,HW4
0437   C3BB CD 7B CE    			call txy51.txy
0438   C3BE 01 03 70    			ld	bc,#7003
0439   C3C1 ED 43 1F CF 			ld	(txy51.cursor),bc
0440   C3C5 21 E2 F4    			ld	hl,HW5
0441   C3C8 CD 7B CE    			call txy51.txy
0442   C3CB 01 03 78    			ld	bc,#7803
0443   C3CE ED 43 1F CF 			ld	(txy51.cursor),bc
0444   C3D2 21 FE F4    			ld	hl,HW6
0445   C3D5 CD 7B CE    			call txy51.txy
0446   C3D8             
0447   C3D8 01 00 80    			ld	bc,#8000
0448   C3DB ED 43 1F CF 			ld	(txy51.cursor),bc
0449   C3DF 21 2C F5    			ld	hl,CONF1
0450   C3E2 CD 7B CE    			call txy51.txy
0451   C3E5 01 03 88    			ld	bc,#8803
0452   C3E8 ED 43 1F CF 			ld	(txy51.cursor),bc
0453   C3EC 21 42 F5    			ld	hl,CONF2
0454   C3EF CD 7B CE    			call txy51.txy
0455   C3F2 01 03 90    			ld	bc,#9003
0456   C3F5 ED 43 1F CF 			ld	(txy51.cursor),bc
0457   C3F9 21 84 F5    			ld	hl,CONF3
0458   C3FC CD 7B CE    			call txy51.txy
0459   C3FF 01 03 98    			ld	bc,#9803
0460   C402 ED 43 1F CF 			ld	(txy51.cursor),bc
0461   C406 21 C2 F5    			ld	hl,CONF4
0462   C409 CD 7B CE    			call txy51.txy
0463   C40C             		
0464   C40C             	
0465   C40C             //carymary2				
0466   C40C 01 00 A6    			 ld bc,#A600
0467   C40F 11 FF A6    			 ld de,#A6ff
0468   C412 CD BD CC    			 call draw_jugo.DRAW
0469   C415             			
0470   C415 CD 06 D9    			call cf.IDENT
0471   C418 01 7B 70    			ld	bc,#707B
0472   C41B ED 43 1F CF 			ld	(txy51.cursor),bc
0473   C41F 20 0C       			jr nz,cferr
0474   C421             ;model
0475   C421 21 52 DA    			ld   hl,cf.BUFFER+54
0476   C424 06 28       			ld   b,40
0477   C426 CD 0B DA    			call cf.PROHOD
0478   C429 DD CB 4F FE 			set  7,(ix+79)			
0479   C42D CD 7B CE    cferr		call txy51.txy
0480   C430             ; configuration tests
0481   C430 AF          			xor a
0482   C431 01 3B 20    			ld bc,#203B				//ZXi portselect
0483   C434 ED 79       			out (c),a
0484   C436 04          			inc b
0485   C437 3D          			dec a					//HW - FF firmware
0486   C438 ED 79       			out (c),a
0487   C43A FB          			ei	
0488   C43B 76          			halt				//waiting for border to get relevant data
0489   C43C 01 FD FF    			ld bc,65533			//real AY active?
0490   C43F 3E 02       			ld a,2
0491   C441 ED 79       			out (c),a
0492   C443 06 BF       			ld b,#BF
0493   C445 ED 79       			out (c),a
0494   C447 06 FF       			ld b,#FF			
0495   C449 ED 78       			in a, (c)
0496   C44B FE 02       			cp 2
0497   C44D 28 0E       			jr z,realayinstalled
0498   C44F 01 3B 20    			ld bc,#203B
0499   C452 3E 81       			ld a,#81
0500   C454 ED 79       			out (c),a
0501   C456 04          			inc b
0502   C457 ED 78       			in a,(c)
0503   C459 CB CF       			set 1,a				//enable reading of MB03+ AYs
0504   C45B ED 79       			out (c),a
0505   C45D             realayinstalled
0506   C45D             ; profi interface setup - dedicated to Hood
0507   C45D AF          			xor a
0508   C45E 01 EF 01    			ld bc,#01EF
0509   C461 ED 79       			out (c),a
0510   C463 3C          			inc a
0511   C464 04          			inc b
0512   C465 ED 79       			out (c),a
0513   C467             
0514   C467             ; set Led Matrix
0515   C467             /*			ld bc,#203B
0516   C467~            			ld a,#4
0517   C467~            			out (c),a
0518   C467~            			inc b
0519   C467~            			ld a,1				// Stereo peaks
0520   C467             			out (c),a*/
0521   C467             //SetUp section
0522   C467 F3          			di
0523   C468 DB 53       			in a, (#53)
0524   C46A 08          			ex af,af'
0525   C46B 3E E0       			ld a, #E0
0526   C46D D3 53       			out (#53),a
0527   C46F 06 10       			ld b,16
0528   C471 21 00 20    			ld hl,#2000
0529   C474 AF          			xor a
0530   C475 B6          2			or (hl)
0531   C476 20 05       			jr nz,3F
0532   C478 23          			inc hl
0533   C479 10 FA       			djnz 2B
0534   C47B 18 26       			jr 8F   			//setup is empty use FPGA default
0535   C47D 06 04       3			ld b,4				// number of register to set
0536   C47F 21 97 C4    			ld hl, setup_tab	
0537   C482 7E          4			ld a,(hl)
0538   C483 C5          			push bc
0539   C484 01 3B 20    			ld bc,#203B
0540   C487 ED 79       			out (c),a
0541   C489 04          			inc b
0542   C48A 23          			inc hl
0543   C48B 5E          			ld e, (hl)
0544   C48C 23          			inc hl
0545   C48D 56          			ld d, (hl)
0546   C48E 23          			inc hl
0547   C48F 1A          			ld a,(de)
0548   C490 ED 79       			out (c),a
0549   C492 C1          			pop bc
0550   C493 10 ED       			djnz 4B
0551   C495 18 0C       			jr 8F
0552   C497 04          setup_tab   db 4
0553   C498 04 20       			dw #2004
0554   C49A 09          			db 9
0555   C49B 09 20       			dw #2009
0556   C49D 0A          			db #A
0557   C49E 0A 20       			dw #200A
0558   C4A0 0B          			db #B
0559   C4A1 0B 20       			dw #200B
0560   C4A3             
0561   C4A3 08          8			ex af,af'
0562   C4A4 D3 53       			out (#53),a
0563   C4A6             
0564   C4A6             loopkey		
0565   C4A6             1			
0566   C4A6 AF          			xor a
0567   C4A7 01 3B 20    			ld bc,#203B				//ZXi portselect
0568   C4AA ED 79       			out (c),a
0569   C4AC 04          			inc b
0570   C4AD 3D          			dec a					//HW - FF firmware
0571   C4AE ED 79       			out (c),a
0572   C4B0 FB          			ei
0573   C4B1             /*			xor a
0574   C4B1~            			ld bc,#203B
0575   C4B1~            			out (c),a
0576   C4B1~            			ld bc,#273B
0577   C4B1~            			in a,(c)
0578   C4B1~            			cp h
0579   C4B1~            			ld h,a
0580   C4B1             			push hl	*/
0581   C4B1 76          			halt
0582   C4B2             //			xor a
0583   C4B2             //			out (254),a
0584   C4B2 F3          			di
0585   C4B3 AF          			xor a
0586   C4B4 01 3B 20    			ld bc,#203B				//ZXi portselect
0587   C4B7 ED 79       			out (c),a
0588   C4B9 01 3B 21    			ld bc,#213B
0589   C4BC 3E 01       			ld a,1					//HW - 1 MB02+
0590   C4BE ED 79       			out (c),a	
0591   C4C0 CD 18 CB    			call clock		
0592   C4C3 CD AC CD    			call iinkey.IINKEY		; waiting for key
0593   C4C6             ;			pop hl		
0594   C4C6 28 DE       			jr z,1B
0595   C4C8             
0596   C4C8 FE 30       			cp "0"
0597   C4CA 20 0E       			jr nz,1F
0598   C4CC 3E 09       			ld a,9
0599   C4CE 01 3B 20    			ld bc,#203B				//test pattern
0600   C4D1 ED 79       			out (c),a
0601   C4D3 01 3B 21    			ld bc,#213B
0602   C4D6 3E FF       			ld a,#FF
0603   C4D8 ED 79       			out (c),a
0604   C4DA FE 39       1			cp "9"
0605   C4DC 20 0E       			jr nz,1F
0606   C4DE 3E 09       			ld a,9
0607   C4E0 01 3B 20    			ld bc,#203B				//test text mode
0608   C4E3 ED 79       			out (c),a
0609   C4E5 01 3B 21    			ld bc,#213B
0610   C4E8 3E FE       			ld a,#FE
0611   C4EA ED 79       			out (c),a
0612   C4EC FE 38       1			cp "8"
0613   C4EE 20 0E       			jr nz,1F
0614   C4F0 3E 09       			ld a,9
0615   C4F2 01 3B 20    			ld bc,#203B				//text mode
0616   C4F5 ED 79       			out (c),a
0617   C4F7 01 3B 21    			ld bc,#213B
0618   C4FA 3E 80       			ld a,#80
0619   C4FC ED 79       			out (c),a
0620   C4FE FE 37       1			cp "7"
0621   C500 20 0E       			jr nz,1F
0622   C502 3E 09       			ld a,9
0623   C504 01 3B 20    			ld bc,#203B				//mode 1
0624   C507 ED 79       			out (c),a
0625   C509 01 3B 21    			ld bc,#213B
0626   C50C 3E 01       			ld a,#01
0627   C50E ED 79       			out (c),a
0628   C510 FE 36       1			cp "6"
0629   C512 20 0E       			jr nz,1F
0630   C514 3E 09       			ld a,9
0631   C516 01 3B 20    			ld bc,#203B				//mode 2
0632   C519 ED 79       			out (c),a
0633   C51B 01 3B 21    			ld bc,#213B
0634   C51E 3E 02       			ld a,#02
0635   C520 ED 79       			out (c),a	
0636   C522 FE 35       1			cp "5"
0637   C524 20 0E       			jr nz,1F
0638   C526 3E 09       			ld a,9
0639   C528 01 3B 20    			ld bc,#203B				//mode 3
0640   C52B ED 79       			out (c),a
0641   C52D 01 3B 21    			ld bc,#213B
0642   C530 3E 03       			ld a,#03
0643   C532 ED 79       			out (c),a									
0644   C534 FE 50       1			cp "P"
0645   C536 20 10       			jr nz,1F
0646   C538 3E 0A       			ld a,#A
0647   C53A 01 3B 20    			ld bc,#203B				//Sync on
0648   C53D ED 79       			out (c),a
0649   C53F 01 3B 21    			ld bc,#213B
0650   C542 ED 78       			in a,(c)
0651   C544 F6 02       			or 2
0652   C546 ED 79       			out (c),a
0653   C548 FE 4F       1			cp "O"
0654   C54A 20 10       			jr nz,1F
0655   C54C 3E 0A       			ld a,#A
0656   C54E 01 3B 20    			ld bc,#203B				//Sync off
0657   C551 ED 79       			out (c),a
0658   C553 01 3B 21    			ld bc,#213B
0659   C556 ED 78       			in a,(c)
0660   C558 E6 FD       			and %11111101
0661   C55A ED 79       			out (c),a
0662   C55C FE 4C       1			cp "L"
0663   C55E 20 10       			jr nz,1F
0664   C560 3E 0A       			ld a,#A
0665   C562 01 3B 20    			ld bc,#203B				//DVI on
0666   C565 ED 79       			out (c),a
0667   C567 01 3B 21    			ld bc,#213B
0668   C56A ED 78       			in a,(c)
0669   C56C F6 01       			or 1
0670   C56E ED 79       			out (c),a
0671   C570 FE 4B       1			cp "K"
0672   C572 20 10       			jr nz,1F
0673   C574 3E 0A       			ld a,#A
0674   C576 01 3B 20    			ld bc,#203B				//HDMI off
0675   C579 ED 79       			out (c),a
0676   C57B 01 3B 21    			ld bc,#213B
0677   C57E ED 78       			in a,(c)
0678   C580 E6 FE       			and %11111110
0679   C582 ED 79       			out (c),a	
0680   C584 FE 53       1			cp "S"					//SetUp/Bios
0681   C586 20 1E       			jr nz,1F
0682   C588 AF          			xor a
0683   C589 01 3B 20    			ld bc,#203B					//ZXi portselect
0684   C58C ED 79       			out (c),a
0685   C58E 01 3B 21    			ld bc,#213B
0686   C591 3E FF       			ld a,255					//HW - FF - Firmware
0687   C593 ED 79       			out (c),a
0688   C595 AF          			xor a
0689   C596 D3 27       			out (#27),a
0690   C598 D3 67       			out (#67),a
0691   C59A 3E 16       			ld a,22														
0692   C59C D3 07       			out (#07),a
0693   C59E 3C          			inc a
0694   C59F D3 47       			out (#47),a
0695   C5A1 3E 60       			ld a,#60					//flash enable, read only
0696   C5A3 D3 53       			out (#53),a
0697   C5A5 C7          			rst 0
0698   C5A6             
0699   C5A6 FE 33       1			cp "3"
0700   C5A8 C2 34 C6    			jp nz,next1
0701   C5AB CD 89 CC    			call clean
0702   C5AE 01 00 B8    			ld bc,#B800
0703   C5B1 ED 43 EB D7 			ld	(txy32.cursor),bc
0704   C5B5 21 2B F4    			LD HL, STRIPS
0705   C5B8 CD 25 D7    			call txy32.txy
0706   C5BB 01 00 BF    			ld bc,#BF00
0707   C5BE 11 FF BF    			ld de,#BFFF
0708   C5C1 CD BD CC    			call draw_jugo.DRAW				
0709   C5C4             /*			ld de,#0E00
0710   C5C4~            	        ld hl,EsxLogo
0711   C5C4             			call sprite2.OK*/
0712   C5C4 01 08 58    			ld	bc,#5808
0713   C5C7 ED 43 1F CF 			ld	(txy51.cursor),bc
0714   C5CB 21 BD F6    			ld	hl,ULT1
0715   C5CE CD 7B CE    			call txy51.txy
0716   C5D1 01 08 60    			ld	bc,#6008
0717   C5D4 ED 43 1F CF 			ld	(txy51.cursor),bc
0718   C5D8 21 F4 F6    			ld	hl,ULT2
0719   C5DB CD 7B CE    			call txy51.txy
0720   C5DE 01 08 68    			ld	bc,#6808
0721   C5E1 ED 43 1F CF 			ld	(txy51.cursor),bc
0722   C5E5 21 26 F7    			ld	hl,ULT3
0723   C5E8 CD 7B CE    			call txy51.txy
0724   C5EB 01 08 78    			ld	bc,#7808
0725   C5EE ED 43 1F CF 			ld	(txy51.cursor),bc
0726   C5F2 21 50 F7    			ld	hl,ULT4
0727   C5F5 CD 7B CE    			call txy51.txy
0728   C5F8 01 08 80    			ld	bc,#8008
0729   C5FB ED 43 1F CF 			ld	(txy51.cursor),bc
0730   C5FF 21 85 F7    			ld	hl,ULT5
0731   C602 CD 7B CE    			call txy51.txy
0732   C605 01 08 88    			ld	bc,#8808
0733   C608 ED 43 1F CF 			ld	(txy51.cursor),bc
0734   C60C 21 B3 F7    			ld	hl,ULT6
0735   C60F CD 7B CE    			call txy51.txy
0736   C612 01 08 A0    			ld	bc,#A008
0737   C615 ED 43 1F CF 			ld	(txy51.cursor),bc
0738   C619 21 E6 F7    			ld	hl,ULT7
0739   C61C CD 7B CE    			call txy51.txy
0740   C61F 01 08 A8    			ld	bc,#A808
0741   C622 ED 43 1F CF 			ld	(txy51.cursor),bc
0742   C626 21 1A F8    			ld	hl,ULT8
0743   C629 CD 7B CE    			call txy51.txy											
0744   C62C CD AC CD    holdkey5	call iinkey.IINKEY
0745   C62F 28 FB       			jr z,holdkey5			
0746   C631 C3 85 C0    			jp ramcode
0747   C634             
0748   C634 FE 11       next1		cp 11h					; break
0749   C636 20 20       			jr nz,2F				; no break	
0750   C638 AF          			xor a
0751   C639 01 3B 20    			ld bc,#203B				//ZXi portselect
0752   C63C ED 79       			out (c),a
0753   C63E 01 3B 21    			ld bc,#213B
0754   C641             									//HW - 0
0755   C641 ED 79       			out (c),a									
0756   C643 01 FD 1F    			ld bc,8189				;ZX128+2A rom
0757   C646 ED 79       			out (c),a			
0758   C648 01 FD 7F    			ld bc,32765				;ZX128 rom0 
0759   C64B ED 79       			out (c),a
0760   C64D ED 47       			ld i,a
0761   C64F ED 46       			im 0
0762   C651 3D          			dec a					// A should have #FF	
0763   C652 31 FF FF    			ld sp,#ffff				//Real reset simulation. Sp is set to #ffff,
0764   C655 C3 00 00    			jp 0					; jp to 0, rst 0 is not good becaus it is call
0765   C658             2			
0766   C658 FE 31       			cp '1'					//key 1
0767   C65A C2 E0 C6    			jp nz,3F
0768   C65D CD 89 CC    			call clean
0769   C660 01 00 B8    			ld bc,#B800
0770   C663 ED 43 EB D7 			ld	(txy32.cursor),bc
0771   C667 21 2B F4    			LD HL, STRIPS
0772   C66A CD 25 D7    			call txy32.txy
0773   C66D 01 00 BF    			ld bc,#BF00
0774   C670 11 FF BF    			ld de,#BFFF
0775   C673 CD BD CC    			call draw_jugo.DRAW				
0776   C676 11 03 0D    			ld de,#0D03
0777   C679 21 D9 ED    	        ld hl,BSDOSLogo
0778   C67C CD 02 D8    			call sprite2.OK
0779   C67F 01 56 98    			ld	bc,#9856
0780   C682 ED 43 1F CF 			ld	(txy51.cursor),bc
0781   C686 21 8D F6    			ld	hl,BSD1
0782   C689 CD 7B CE    			call txy51.txy					
0783   C68C             
0784   C68C CD AC CD    holdkey3	call iinkey.IINKEY
0785   C68F 20 FB       			jr nz,holdkey3	
0786   C691             
0787   C691 06 06       			ld b,6					//number of pages to transfer					
0788   C693 C5          22			push bc
0789   C694 AF          			xor a
0790   C695 01 3B 20    			ld bc,#203B					//ZXi portselect
0791   C698 ED 79       			out (c),a
0792   C69A 01 3B 21    			ld bc,#213B
0793   C69D 3E FF       			ld a,255					//HW - FF - Firmware
0794   C69F ED 79       			out (c),a
0795   C6A1 AF          			xor a
0796   C6A2 D3 27       			out (#27),a
0797   C6A4 D3 67       			out (#67),a
0798   C6A6 C1          			pop bc
0799   C6A7 C5          			push bc
0800   C6A8 3E 08       			ld a,8						;first Flash block
0801   C6AA 05          			dec b
0802   C6AB 80          			add a,b	
0803   C6AC 80          			add a,b						;multiplication by 2									
0804   C6AD D3 07       			out (#07),a
0805   C6AF 3C          			inc a
0806   C6B0 D3 47       			out (#47),a
0807   C6B2             
0808   C6B2 21 00 00    			ld hl,0
0809   C6B5 11 00 80    			ld de,32768
0810   C6B8 01 00 40    			ld bc,16384
0811   C6BB ED B0       			ldir
0812   C6BD             
0813   C6BD 01 3B 21    			ld bc,#213B
0814   C6C0 3E 01       			ld a,1						//HW - 1 - MB02+
0815   C6C2 ED 79       			out (c),a
0816   C6C4 C1          			pop bc
0817   C6C5 C5          			push bc
0818   C6C6 3E 60       			ld a,96						;first MB02+ RAM
0819   C6C8 05          			dec b
0820   C6C9 80          			add a,b
0821   C6CA D3 17       			out (23), a
0822   C6CC 21 00 80    			ld hl,32768
0823   C6CF 11 00 00    			ld de,0
0824   C6D2 01 00 40    			ld bc,16384
0825   C6D5 ED B0       			ldir
0826   C6D7 C1          			pop bc
0827   C6D8 10 B9       			djnz 22B
0828   C6DA             
0829   C6DA 3E 40       			ld a,64
0830   C6DC D3 17       			out (23),a
0831   C6DE 18 2F       			jr 4F
0832   C6E0             3			
0833   C6E0 FE 21       			cp '!'					; key !
0834   C6E2 20 6F       			jr nz, 5F
0835   C6E4             			
0836   C6E4 CD 89 CC    			call clean
0837   C6E7 01 00 B8    			ld bc,#B800
0838   C6EA ED 43 EB D7 			ld	(txy32.cursor),bc
0839   C6EE 21 2B F4    			LD HL, STRIPS
0840   C6F1 CD 25 D7    			call txy32.txy
0841   C6F4 01 00 BF    			ld bc,#BF00
0842   C6F7 11 FF BF    			ld de,#BFFF
0843   C6FA CD BD CC    			call draw_jugo.DRAW				
0844   C6FD             /*			ld de,#0E00
0845   C6FD~            	        ld hl,EsxLogo
0846   C6FD             			call sprite2.OK*/
0847   C6FD 01 52 90    			ld	bc,#9052
0848   C700 ED 43 1F CF 			ld	(txy51.cursor),bc
0849   C704 21 A8 F6    			ld	hl,BSD2
0850   C707 CD 7B CE    			call txy51.txy
0851   C70A CD AC CD    holdkey4	call iinkey.IINKEY
0852   C70D 20 FB       			jr nz,holdkey4
0853   C70F             
0854   C70F AF          4			xor a
0855   C710 01 3B 20    			ld bc,#203B					//ZXi portselect
0856   C713 ED 79       			out (c),a
0857   C715 01 3B 21    			ld bc,#213B
0858   C718 3E FF       			ld a,255					//HW - FF - Firmware
0859   C71A ED 79       			out (c),a
0860   C71C AF          			xor a
0861   C71D D3 27       			out (#27),a
0862   C71F D3 67       			out (#67),a
0863   C721 3E 06       			ld a,6						//
0864   C723 D3 07       			out (#07),a
0865   C725 3C          			inc a
0866   C726 D3 47       			out (#47),a
0867   C728 21 00 00    			ld hl,0			; run EasyHDD
0868   C72B 11 00 80    			ld de,32768
0869   C72E 01 00 40    			ld bc,16384
0870   C731 ED B0       			ldir
0871   C733 01 3B 21    			ld bc,#213B
0872   C736 3E 01       			ld a,1					//HW - 1 - MB02+
0873   C738 ED 79       			out (c),a					
0874   C73A CD 00 80    			call 32768
0875   C73D             //autosys/autoexe
0876   C73D 3E 61       			ld a,#61	;novy kod, opsano ze Shrekova Flashobootu
0877   C73F D3 17       			out (#17),a
0878   C741 3E 1E       			ld a,#1E
0879   C743 E7          			rst #20		;sluzba .KILL
0880   C744 1E 03       			ld e,3
0881   C746 3E 13       			ld a,#13
0882   C748 E7          			rst #20
0883   C749 1E 00       			ld e,0
0884   C74B 3E 14       			ld a,#14	;zvol disk 3, adresar 0
0885   C74D E7          			rst #20
0886   C74E 3E 30       			ld a,#30
0887   C750 E7          			rst #20		;sluzba #30, start systemu. Pokud je autosys nalezen, dale se v kodu nepokracuje
0888   C751             			/*ld a,#40	;soubor autosys nenalezen
0889   C751~            			out (#17),a	;tedy vykonej reset
0890   C751             			jp #3906*/
0891   C751 18 04       			jr 6F
0892   C753             
0893   C753 FE 65       5			cp 'e'					// key e
0894   C755 20 14       			jr nz, 7F				// no key
0895   C757             
0896   C757             6
0897   C757 AF          			xor a
0898   C758 01 3B 20    			ld bc,#203B				//ZXi portselect
0899   C75B ED 79       			out (c),a
0900   C75D 01 3B 21    			ld bc,#213B
0901   C760 3E 01       			ld a,1					//HW - 1 - MB02+
0902   C762 ED 79       			out (c),a			
0903   C764 3E 40       			ld a,64					// 128K reset in BSROM140
0904   C766 D3 17       			out (23),a
0905   C768 C3 06 39    			jp #3906				//jp to bsrom140
0906   C76B             			
0907   C76B FE 64       7			cp 'd'
0908   C76D 20 4B       			jr nz, 8F				
0909   C76F             ; clear below 3/3			
0910   C76F 3E 07       			ld   a,7
0911   C771 21 00 5A    			ld   HL,22528+512
0912   C774 11 01 5A    			ld   DE,22529+512
0913   C777 01 FF 00    			ld   BC,255
0914   C77A 77          			ld   (HL),a
0915   C77B ED B0       			ldir
0916   C77D 21 00 50    			ld   HL,20480
0917   C780 11 01 50    			ld   DE,20481
0918   C783 01 FF 07    			ld   BC,2047
0919   C786 75          			ld   (HL),l
0920   C787 ED B0       			ldir
0921   C789             
0922   C789 AF          			xor a
0923   C78A 01 3B 20    			ld bc,#203B					//ZXi portselect
0924   C78D ED 79       			out (c),a
0925   C78F 01 3B 21    			ld bc,#213B
0926   C792 3E FF       			ld a,255					//HW - FF - Firmware
0927   C794 ED 79       			out (c),a
0928   C796 AF          			xor a
0929   C797 D3 27       			out (#27),a
0930   C799 D3 67       			out (#67),a
0931   C79B 3E 14       			ld a,20														
0932   C79D D3 07       			out (#07),a
0933   C79F 3C          			inc a
0934   C7A0 D3 47       			out (#47),a
0935   C7A2 3E 60       			ld a,#60					//flash enable, read only
0936   C7A4 D3 53       			out (#53),a
0937   C7A6 21 00 00    			ld hl,0
0938   C7A9 11 78 69    			ld de,27000
0939   C7AC 01 70 17    			ld bc,6000
0940   C7AF ED B0       			ldir
0941   C7B1 AF          			xor a						//firmware flash page														
0942   C7B2 D3 07       			out (#07),a
0943   C7B4 3C          			inc a
0944   C7B5 D3 47       			out (#47),a
0945   C7B7             
0946   C7B7 C3 78 69    			jp 27000
0947   C7BA             			
0948   C7BA FE 74       8			cp 't'					// key t - zx diagnostics
0949   C7BC 20 1E       			jr nz, 1F				// no key
0950   C7BE AF          			xor a
0951   C7BF 01 3B 20    			ld bc,#203B				//ZXi portselect
0952   C7C2 ED 79       			out (c),a
0953   C7C4 01 3B 21    			ld bc,#213B
0954   C7C7 3E FF       			ld a,255				//HW - FF - Firmware
0955   C7C9 ED 79       			out (c),a
0956   C7CB AF          			xor a
0957   C7CC D3 27       			out (#27),a
0958   C7CE D3 67       			out (#67),a
0959   C7D0 3E 02       			ld a,2
0960   C7D2 D3 07       			out (#07),a
0961   C7D4 3C          			inc a
0962   C7D5 D3 47       			out (#47),a
0963   C7D7 3E 60       			ld a,%01100000	;enable flash write disable
0964   C7D9 D3 53       			out (#53),a
0965   C7DB C7          			rst 0
0966   C7DC             
0967   C7DC FE 06       1			cp 6					// key shitf+2(capslock) - ESXDOS DivMMC warm start
0968   C7DE 20 1F       			jr nz, 9F
0969   C7E0 AF          			xor a
0970   C7E1             //			out (23),a 
0971   C7E1 01 3B 20    			ld bc,#203B				//ZXi portselect
0972   C7E4 ED 79       			out (c),a
0973   C7E6 01 3B 21    			ld bc,#213B
0974   C7E9 3E 02       			ld a,2					//HW - 2 - DIVMMC
0975   C7EB ED 79       			out (c),a
0976   C7ED 01 3B 20    			ld bc,#203B				//ZXi portselect 
0977   C7F0 3E 02       			ld a,2
0978   C7F2 ED 79       			out (c),a
0979   C7F4 01 3B 21    			ld bc,#213B
0980   C7F7 AF          			xor a					//IDE - 0 dissable
0981   C7F8 ED 79       			out (c),a			
0982   C7FA D3 E3       			out (#E3),a			//to force cold start zero $2dXX in page 0
0983   C7FC C3 66 00    			jp #66
0984   C7FF             
0985   C7FF FE 32       9			cp '2'					// key 2 - Papaya DOS- ESXDOS DivMMC
0986   C801 20 67       			jr nz, 10F
0987   C803             
0988   C803 CD 89 CC    			call clean
0989   C806 01 00 B8    			ld bc,#B800
0990   C809 ED 43 EB D7 			ld	(txy32.cursor),bc
0991   C80D 21 2B F4    			LD HL, STRIPS
0992   C810 CD 25 D7    			call txy32.txy
0993   C813 01 00 BF    			ld bc,#BF00
0994   C816 11 FF BF    			ld de,#BFFF
0995   C819 CD BD CC    			call draw_jugo.DRAW				
0996   C81C 11 00 0E    			ld de,#0E00
0997   C81F 21 37 E8    	        ld hl,EsxLogo
0998   C822 CD 02 D8    			call sprite2.OK
0999   C825 01 58 94    			ld	bc,#9458
1000   C828 ED 43 1F CF 			ld	(txy51.cursor),bc
1001   C82C 21 7A F6    			ld	hl,ESX1
1002   C82F CD 7B CE    			call txy51.txy					
1003   C832             
1004   C832 CD AC CD    holdkey1	call iinkey.IINKEY
1005   C835 20 FB       			jr nz,holdkey1	
1006   C837             
1007   C837 AF          			xor a
1008   C838             //			out (23),a 
1009   C838 01 3B 20    			ld bc,#203B				//ZXi portselect
1010   C83B ED 79       			out (c),a
1011   C83D 01 3B 21    			ld bc,#213B
1012   C840 3E 02       			ld a,2					//HW - 2 - DIVMMC
1013   C842 ED 79       			out (c),a
1014   C844 01 3B 20    			ld bc,#203B				//ZXi portselect 
1015   C847 3E 02       			ld a,2
1016   C849 ED 79       			out (c),a
1017   C84B 01 3B 21    			ld bc,#213B
1018   C84E AF          			xor a					//IDE - 0 dissable
1019   C84F ED 79       			out (c),a
1020   C851 3E 80       			ld a,128
1021   C853 D3 E3       div_erase	out (#E3),a
1022   C855 21 00 20    			ld hl,8192
1023   C858 11 01 20    			ld de,8193
1024   C85B 01 FF 1F    			ld bc,8191
1025   C85E 75          			ld (hl),l
1026   C85F ED B0       			ldir
1027   C861 3C          			inc a
1028   C862 FE 85       			cp 128+5
1029   C864 20 ED       			jr nz,div_erase		//delete first 32KB od DivMMC RAM
1030   C866 AF          			xor a				//is enought to erase bank0 or
1031   C867 D3 E3       			out (#E3),a			//to force cold start zero $2dXX in page 0
1032   C869 C7          			rst 0
1033   C86A FE 52       10		cp "R"					//restart firmware
1034   C86C 20 1C       			jr nz, 11F
1035   C86E AF          			xor a
1036   C86F 01 3B 20    			ld bc,#203B				//ZXi portselect
1037   C872 ED 79       			out (c),a
1038   C874 01 3B 21    			ld bc,#213B
1039   C877 3E FF       			ld a,255				//HW - FF - Firmware
1040   C879 ED 79       			out (c),a
1041   C87B AF          			xor a
1042   C87C D3 27       			out (#27),a
1043   C87E D3 67       			out (#67),a
1044   C880             ;			ld a,2
1045   C880 D3 07       			out (#07),a
1046   C882 3C          			inc a
1047   C883 D3 47       			out (#47),a
1048   C885 3E 60       			ld a,%01100000	;enable flash write disable
1049   C887 D3 53       			out (#53),a
1050   C889 C7          			rst 0
1051   C88A FE 72       11		cp "r"					//restart to ramcode
1052   C88C 20 03       			jr nz,12F
1053   C88E C3 85 C0    			jp ramcode
1054   C891 FE 54       12		cp "T"					//advance system info
1055   C893 C2 6C CA    			jp nz,14F
1056   C896 CD 89 CC    13			call clean
1057   C899             //carymary2
1058   C899 01 00 B8    			ld bc,#B800
1059   C89C ED 43 EB D7 			ld	(txy32.cursor),bc
1060   C8A0 21 2B F4    			LD HL, STRIPS
1061   C8A3 CD 25 D7    			call txy32.txy
1062   C8A6 01 00 BF    			ld bc,#BF00
1063   C8A9 11 FF BF    			ld de,#BFFF
1064   C8AC CD BD CC    			call draw_jugo.DRAW			
1065   C8AF 11 13 10    			ld de,#1013
1066   C8B2 21 02 E5    	        ld hl,CaroLogo
1067   C8B5 CD 02 D8    			call sprite2.OK
1068   C8B8             
1069   C8B8 AF          			xor a
1070   C8B9 01 3B 20    			ld bc,#203B				//ZXi portselect
1071   C8BC ED 79       			out (c),a
1072   C8BE 3E FF       			ld a,#FF
1073   C8C0 01 3B 21    			ld bc,#213B			
1074   C8C3 ED 79       			out (c),a
1075   C8C5 3E E0       			ld a,#E0				//FRAM active
1076   C8C7 D3 53       			out (#53),a
1077   C8C9             
1078   C8C9 01 00 80    			ld	bc,#8000
1079   C8CC ED 43 1F CF 			ld	(txy51.cursor),bc
1080   C8D0 21 D6 F5    			ld	hl,ADVS0
1081   C8D3 CD 7B CE    			call txy51.txy			
1082   C8D6 21 FF 3F    			ld hl,#3FFF
1083   C8D9 5E          			ld e,(hl)
1084   C8DA 2B          			dec hl
1085   C8DB 7E          			ld a,(hl)
1086   C8DC B3          			or e
1087   C8DD 21 5F F6    			ld hl,LEVEL7
1088   C8E0 20 30       			jr nz, userlevel
1089   C8E2 3A FD 3F    			ld a,(#3FFD)
1090   C8E5 CB 27       			sla a
1091   C8E7 21 59 F6    			ld hl,LEVEL6
1092   C8EA 38 26       			jr c, userlevel
1093   C8EC CB 27       			sla a
1094   C8EE 21 53 F6    			ld hl,LEVEL5
1095   C8F1 38 1F       			jr c, userlevel
1096   C8F3 CB 27       			sla a
1097   C8F5 21 49 F6    			ld hl,LEVEL4
1098   C8F8 38 18       			jr c, userlevel
1099   C8FA CB 27       			sla a
1100   C8FC 21 3F F6    			ld hl,LEVEL3
1101   C8FF 38 11       			jr c, userlevel
1102   C901 CB 27       			sla a
1103   C903 21 37 F6    			ld hl,LEVEL2
1104   C906 38 0A       			jr c, userlevel
1105   C908 CB 27       			sla a
1106   C90A 21 2F F6    			ld hl,LEVEL1
1107   C90D 38 03       			jr c, userlevel
1108   C90F 21 28 F6    			ld hl,LEVEL0
1109   C912 CD 7B CE    userlevel	call txy51.txy				
1110   C915             			
1111   C915 01 00 90    			ld	bc,#9000
1112   C918 ED 43 1F CF 			ld	(txy51.cursor),bc
1113   C91C 21 E7 F5    			ld	hl,ADVS1
1114   C91F CD 7B CE    			call txy51.txy
1115   C922             
1116   C922 21 FC 3F    			ld hl,#3FFC
1117   C925 11 F3 D8    			ld de,xdec_06.zzbin
1118   C928 01 04 00    			ld bc,4
1119   C92B ED B0       			ldir
1120   C92D CD 46 D8    			call xdec_06.bindec
1121   C930 06 0A       			ld b,10
1122   C932 0E 20       			ld c," "
1123   C934 21 F8 D8    			ld hl,xdec_06.zzdec
1124   C937 7E          1			ld a,(hl)
1125   C938 C6 30       			add a,"0"
1126   C93A FE 30       			cp "0"
1127   C93C 20 03       			jr nz,3F
1128   C93E 79          			ld a,c			
1129   C93F 18 02       			jr 2F
1130   C941 0E 30       3			ld c,"0"			
1131   C943 E5          2			push hl
1132   C944 C5          			push bc
1133   C945 CD 95 CE    			call txy51.xy
1134   C948 C1          			pop bc
1135   C949 E1          			pop hl
1136   C94A 23          			inc hl
1137   C94B 10 EA       			djnz 1B
1138   C94D             
1139   C94D 01 00 98    			ld	bc,#9800
1140   C950 ED 43 1F CF 			ld	(txy51.cursor),bc
1141   C954 21 F4 F5    			ld	hl,ADVS2
1142   C957 CD 7B CE    			call txy51.txy
1143   C95A             
1144   C95A 21 F8 3F    			ld hl,#3FF8
1145   C95D 11 F3 D8    			ld de,xdec_06.zzbin
1146   C960 01 04 00    			ld bc,4
1147   C963 ED B0       			ldir
1148   C965 CD 46 D8    			call xdec_06.bindec
1149   C968 06 0A       			ld b,10
1150   C96A 0E 20       			ld c," "
1151   C96C 21 F8 D8    			ld hl,xdec_06.zzdec
1152   C96F 7E          1			ld a,(hl)
1153   C970 C6 30       			add a,"0"
1154   C972 FE 30       			cp "0"
1155   C974 20 03       			jr nz,3F
1156   C976 79          			ld a,c			
1157   C977 18 02       			jr 2F
1158   C979 0E 30       3			ld c,"0"			
1159   C97B E5          2			push hl
1160   C97C C5          			push bc
1161   C97D CD 95 CE    			call txy51.xy
1162   C980 C1          			pop bc
1163   C981 E1          			pop hl
1164   C982 23          			inc hl
1165   C983 10 EA       			djnz 1B
1166   C985             
1167   C985 01 00 A0    			ld	bc,#A000
1168   C988 ED 43 1F CF 			ld	(txy51.cursor),bc
1169   C98C 21 01 F6    			ld	hl,ADVS3
1170   C98F CD 7B CE    			call txy51.txy
1171   C992             
1172   C992 21 F4 3F    			ld hl,#3FF4
1173   C995 11 F3 D8    			ld de,xdec_06.zzbin
1174   C998 01 04 00    			ld bc,4
1175   C99B ED B0       			ldir
1176   C99D CD 46 D8    			call xdec_06.bindec
1177   C9A0 06 0A       			ld b,10
1178   C9A2 0E 20       			ld c," "
1179   C9A4 21 F8 D8    			ld hl,xdec_06.zzdec
1180   C9A7 7E          1			ld a,(hl)
1181   C9A8 C6 30       			add a,"0"
1182   C9AA FE 30       			cp "0"
1183   C9AC 20 03       			jr nz,3F
1184   C9AE 79          			ld a,c			
1185   C9AF 18 02       			jr 2F
1186   C9B1 0E 30       3			ld c,"0"			
1187   C9B3 E5          2			push hl
1188   C9B4 C5          			push bc
1189   C9B5 CD 95 CE    			call txy51.xy
1190   C9B8 C1          			pop bc
1191   C9B9 E1          			pop hl
1192   C9BA 23          			inc hl
1193   C9BB 10 EA       			djnz 1B
1194   C9BD             
1195   C9BD 01 00 A8    			ld	bc,#A800
1196   C9C0 ED 43 1F CF 			ld	(txy51.cursor),bc
1197   C9C4 21 0E F6    			ld	hl,ADVS4
1198   C9C7 CD 7B CE    			call txy51.txy
1199   C9CA             
1200   C9CA 21 F0 3F    			ld hl,#3FF0
1201   C9CD 11 F3 D8    			ld de,xdec_06.zzbin
1202   C9D0 01 04 00    			ld bc,4
1203   C9D3 ED B0       			ldir
1204   C9D5 CD 46 D8    			call xdec_06.bindec
1205   C9D8 06 0A       			ld b,10
1206   C9DA 0E 20       			ld c," "
1207   C9DC 21 F8 D8    			ld hl,xdec_06.zzdec
1208   C9DF 7E          1			ld a,(hl)
1209   C9E0 C6 30       			add a,"0"
1210   C9E2 FE 30       			cp "0"
1211   C9E4 20 03       			jr nz,3F
1212   C9E6 79          			ld a,c			
1213   C9E7 18 02       			jr 2F
1214   C9E9 0E 30       3			ld c,"0"			
1215   C9EB E5          2			push hl
1216   C9EC C5          			push bc
1217   C9ED CD 95 CE    			call txy51.xy
1218   C9F0 C1          			pop bc
1219   C9F1 E1          			pop hl
1220   C9F2 23          			inc hl
1221   C9F3 10 EA       			djnz 1B
1222   C9F5             
1223   C9F5 01 00 B0    			ld	bc,#B000
1224   C9F8 ED 43 1F CF 			ld	(txy51.cursor),bc
1225   C9FC 21 1B F6    			ld	hl,ADVS5
1226   C9FF CD 7B CE    			call txy51.txy
1227   CA02             
1228   CA02 21 EC 3F    			ld hl,#3FEC
1229   CA05 11 F3 D8    			ld de,xdec_06.zzbin
1230   CA08 01 04 00    			ld bc,4
1231   CA0B ED B0       			ldir
1232   CA0D CD 46 D8    			call xdec_06.bindec
1233   CA10 06 0A       			ld b,10
1234   CA12 0E 20       			ld c," "
1235   CA14 21 F8 D8    			ld hl,xdec_06.zzdec
1236   CA17 7E          1			ld a,(hl)
1237   CA18 C6 30       			add a,"0"
1238   CA1A FE 30       			cp "0"
1239   CA1C 20 03       			jr nz,3F
1240   CA1E 79          			ld a,c			
1241   CA1F 18 02       			jr 2F
1242   CA21 0E 30       3			ld c,"0"			
1243   CA23 E5          2			push hl
1244   CA24 C5          			push bc
1245   CA25 CD 95 CE    			call txy51.xy
1246   CA28 C1          			pop bc
1247   CA29 E1          			pop hl
1248   CA2A 23          			inc hl
1249   CA2B 10 EA       			djnz 1B
1250   CA2D             			;Core Time Stamp FULL
1251   CA2D 01 00 40    			ld	bc,#4000
1252   CA30 ED 43 1F CF 			ld	(txy51.cursor),bc
1253   CA34 21 73 F6    			ld	hl,COREFW1
1254   CA37 CD 7B CE    			call txy51.txy
1255   CA3A 01 17 40    			ld	bc,#4017
1256   CA3D ED 43 1F CF 			ld	(txy51.cursor),bc
1257   CA41 21 78 F6    			ld	hl,COREFW2
1258   CA44 CD 7B CE    			call txy51.txy
1259   CA47 01 21 40    			ld	bc,#4021
1260   CA4A ED 43 1F CF 			ld	(txy51.cursor),bc
1261   CA4E 01 3B 20    			ld bc,#203B
1262   CA51 3E FF       			ld a,#FF
1263   CA53 ED 79       			out (c),a
1264   CA55 06 27       			ld b,#27
1265   CA57 05          1			dec b
1266   CA58 26 00       			ld h,0
1267   CA5A ED 68       			in l,(c)
1268   CA5C C5          			push bc
1269   CA5D CD F9 CA    			call NUMBER1
1270   CA60 C1          			pop bc
1271   CA61 78          			ld a,b
1272   CA62 FE 21       			cp #21
1273   CA64 20 F1       			jr nz, 1B
1274   CA66             
1275   CA66 CD 9F CD    			call iinkey.ANYKEY
1276   CA69 C3 96 C8    			jp 13B
1277   CA6C             
1278   CA6C FE 40       14			cp "@"					//DivIDE
1279   CA6E C2 A6 C4    			jp nz, loopkey
1280   CA71             			
1281   CA71 CD 89 CC    			call clean
1282   CA74 01 00 B8    			ld bc,#B800
1283   CA77 ED 43 EB D7 			ld	(txy32.cursor),bc
1284   CA7B 21 2B F4    			LD HL, STRIPS
1285   CA7E CD 25 D7    			call txy32.txy
1286   CA81 01 00 BF    			ld bc,#BF00
1287   CA84 11 FF BF    			ld de,#BFFF
1288   CA87 CD BD CC    			call draw_jugo.DRAW				
1289   CA8A 11 00 0E    			ld de,#0E00
1290   CA8D 21 37 E8    	        ld hl,EsxLogo
1291   CA90 CD 02 D8    			call sprite2.OK
1292   CA93 01 58 94    			ld	bc,#9458
1293   CA96 ED 43 1F CF 			ld	(txy51.cursor),bc
1294   CA9A 21 7A F6    			ld	hl,ESX1
1295   CA9D CD 7B CE    			call txy51.txy					
1296   CAA0             
1297   CAA0 CD AC CD    holdkey2	call iinkey.IINKEY
1298   CAA3 20 FB       			jr nz,holdkey2	
1299   CAA5 AF          			xor a
1300   CAA6             //			out (23),a
1301   CAA6 01 3B 20    			ld bc,#203B				//ZXi portselect
1302   CAA9 ED 79       			out (c),a
1303   CAAB 01 3B 21    			ld bc,#213B
1304   CAAE 3E 03       			ld a,3					//HW - 3 - DIVMMC/DIVIDE
1305   CAB0 ED 79       			out (c),a
1306   CAB2             
1307   CAB2 01 3B 20    			ld bc,#203B				//ZXi portselect 
1308   CAB5 3E 02       			ld a,2
1309   CAB7 ED 79       			out (c),a
1310   CAB9 01 3B 21    			ld bc,#213B
1311   CABC 3E 02       			ld a,2					//IDE - 2 PVL ports- DIVMMC/DIVIDE
1312   CABE ED 79       			out (c),a
1313   CAC0             
1314   CAC0 01 3B 20    			ld bc,#203B				//ZXi portselect 
1315   CAC3 3E 01       			ld a,1					//Audio
1316   CAC5 ED 79       			out (c),a
1317   CAC7 01 3B 21    			ld bc,#213B
1318   CACA 3E EF       			ld a,%11101111  		//dissable GS
1319   CACC ED 79       			out (c),a
1320   CACE             
1321   CACE 3E 80       			ld a,128
1322   CAD0 D3 E3       div_erase2	out (#E3),a
1323   CAD2 21 00 20    			ld hl,8192
1324   CAD5 11 01 20    			ld de,8193
1325   CAD8 01 FF 1F    			ld bc,8191
1326   CADB 75          			ld (hl),l
1327   CADC ED B0       			ldir
1328   CADE 3C          			inc a
1329   CADF FE 85       			cp 128+5
1330   CAE1 20 ED       			jr nz,div_erase2			//delete first 32KB od DivIde RAM
1331   CAE3 AF          			xor a						//is enought to erase bank0 or
1332   CAE4 D3 E3       			out (#E3),a					//to force cold start zero $2dXX in page 0
1333   CAE6 C7          			rst 0
1334   CAE7             
1335   CAE7             ;------------------------------
1336   CAE7             ;HL-HODNOTA
1337   CAE7             ;TISKNE CISLO TYPU INTEGER
1338   CAE7 11 F0 D8    NUMBER4  ld   de,-10000
1339   CAEA CD 05 CB             call NUM_JED
1340   CAED 11 18 FC    NUMBER3  ld   de,-1000
1341   CAF0 CD 05 CB             call NUM_JED
1342   CAF3 11 9C FF    NUMBER2  ld   de,-100
1343   CAF6 CD 05 CB             call NUM_JED
1344   CAF9 11 F6 FF    NUMBER1  ld   de,-10
1345   CAFC CD 05 CB             call NUM_JED
1346   CAFF 7D          NUMBER0  ld   a,l
1347   CB00 C6 30                add  a,48
1348   CB02 C3 95 CE             jp   txy51.xy
1349   CB05             
1350   CB05 AF          NUM_JED  xor  a
1351   CB06 19          NUM_JED1 add  hl,de
1352   CB07 30 03                jr   nc,NUM_PRIC
1353   CB09 3C                   inc  a
1354   CB0A 18 FA                jr   NUM_JED1
1355   CB0C ED 52       NUM_PRIC sbc  hl,de
1356   CB0E C6 30                add  a,48
1357   CB10 C5                   push bc
1358   CB11 E5                   push hl
1359   CB12 CD 95 CE             call txy51.xy
1360   CB15 E1                   pop  hl
1361   CB16 C1                   pop  bc
1362   CB17                      ;;inc  c
1363   CB17 C9                   ret
1364   CB18             
1365   CB18             clock
1366   CB18 DD 21 57 CC 			ld ix,clockbuff
1367   CB1C AF          			xor a
1368   CB1D 01 3B 20    			ld bc,#203B
1369   CB20 ED 79       			out (c),a
1370   CB22 01 3B 27    			ld bc,#273B
1371   CB25 ED 78       			in a,(c)
1372   CB27 F5          			push af
1373   CB28 E6 0F       			and #0F
1374   CB2A F6 B0       			or #B0
1375   CB2C DD 77 15    			ld (ix+21),a		//1sec
1376   CB2F F1          			pop af
1377   CB30 CB 1F       			rr a
1378   CB32 CB 1F       			rr a
1379   CB34 CB 1F       			rr a
1380   CB36 CB 1F       			rr a
1381   CB38 E6 07       			and #07
1382   CB3A F6 30       			or 48
1383   CB3C DD 77 14    			ld (ix+20),a		//10sec
1384   CB3F 3E 01       			ld a,1
1385   CB41 01 3B 20    			ld bc,#203B
1386   CB44 ED 79       			out (c),a
1387   CB46 01 3B 27    			ld bc,#273B
1388   CB49 ED 78       			in a,(c)
1389   CB4B F5          			push af			
1390   CB4C E6 0F       			and #0F
1391   CB4E F6 30       			or 48
1392   CB50 DD 77 12    			ld (ix+18),a		//1min
1393   CB53 F1          			pop af
1394   CB54 CB 1F       			rr a
1395   CB56 CB 1F       			rr a
1396   CB58 CB 1F       			rr a
1397   CB5A CB 1F       			rr a
1398   CB5C E6 07       			and #07
1399   CB5E F6 30       			or 48
1400   CB60 DD 77 11    			ld (ix+17),a		//10min
1401   CB63 3E 02       			ld a,2
1402   CB65 01 3B 20    			ld bc,#203B
1403   CB68 ED 79       			out (c),a
1404   CB6A 01 3B 27    			ld bc,#273B
1405   CB6D ED 78       			in a,(c)
1406   CB6F F5          			push af
1407   CB70 E6 0F       			and #0F
1408   CB72 F6 30       			or 48
1409   CB74 DD 77 0F    			ld (ix+15),a		//1hour
1410   CB77 F1          			pop af
1411   CB78 CB 1F       			rr a
1412   CB7A CB 1F       			rr a
1413   CB7C CB 1F       			rr a
1414   CB7E CB 1F       			rr a
1415   CB80 E6 07       			and #07
1416   CB82 F6 30       			or 48
1417   CB84 DD 77 0E    			ld (ix+14),a		//10hour
1418   CB87 3E 03       			ld a,3
1419   CB89 01 3B 20    			ld bc,#203B
1420   CB8C ED 79       			out (c),a
1421   CB8E 01 3B 27    			ld bc,#273B
1422   CB91 ED 78       			in a,(c)
1423   CB93 3D          			dec a
1424   CB94 E6 07       			and #7
1425   CB96 CB 27       			sla	a
1426   CB98 CB 27       			sla	a
1427   CB9A 21 6D CC    			ld hl, weekdays
1428   CB9D 16 00       			ld d,0
1429   CB9F 5F          			ld e,a
1430   CBA0 19          			add hl,de
1431   CBA1 11 61 CC    			ld de, clockbuff2
1432   CBA4 01 04 00    			ld bc,4
1433   CBA7 ED B0       			ldir
1434   CBA9 3E 04       			ld a,4
1435   CBAB 01 3B 20    			ld bc,#203B
1436   CBAE ED 79       			out (c),a
1437   CBB0 01 3B 27    			ld bc,#273B
1438   CBB3 ED 78       			in a,(c)
1439   CBB5 F5          			push af
1440   CBB6 E6 0F       			and #0F
1441   CBB8 F6 30       			or 48
1442   CBBA DD 77 01    			ld (ix+1),a		//1day
1443   CBBD F1          			pop af
1444   CBBE CB 1F       			rr a
1445   CBC0 CB 1F       			rr a
1446   CBC2 CB 1F       			rr a
1447   CBC4 CB 1F       			rr a
1448   CBC6 E6 03       			and #03
1449   CBC8 F6 30       			or 48
1450   CBCA DD 77 00    			ld (ix+0),a		//10day	
1451   CBCD 3E 05       			ld a,5
1452   CBCF 01 3B 20    			ld bc,#203B
1453   CBD2 ED 79       			out (c),a
1454   CBD4 01 3B 27    			ld bc,#273B
1455   CBD7 ED 78       			in a,(c)
1456   CBD9 F5          			push af
1457   CBDA E6 0F       			and #0F
1458   CBDC F6 30       			or 48
1459   CBDE DD 77 04    			ld (ix+4),a		//1month
1460   CBE1 F1          			pop af
1461   CBE2 CB 1F       			rr a
1462   CBE4 CB 1F       			rr a
1463   CBE6 CB 1F       			rr a
1464   CBE8 CB 1F       			rr a
1465   CBEA E6 01       			and #01
1466   CBEC F6 30       			or 48
1467   CBEE DD 77 03    			ld (ix+3),a		//10month
1468   CBF1 3E 06       			ld a,6
1469   CBF3 01 3B 20    			ld bc,#203B
1470   CBF6 ED 79       			out (c),a
1471   CBF8 01 3B 27    			ld bc,#273B
1472   CBFB ED 78       			in a,(c)
1473   CBFD F5          			push af
1474   CBFE E6 0F       			and #0F
1475   CC00 F6 B0       			or #B0
1476   CC02 DD 77 09    			ld (ix+9),a		//1year
1477   CC05 F1          			pop af
1478   CC06 CB 1F       			rr a
1479   CC08 CB 1F       			rr a
1480   CC0A CB 1F       			rr a
1481   CC0C CB 1F       			rr a
1482   CC0E E6 0F       			and #0F
1483   CC10 F6 30       			or 48
1484   CC12 DD 77 08    			ld (ix+8),a		//10year
1485   CC15             
1486   CC15             //			ld a,1
1487   CC15             //			out (254),a
1488   CC15             
1489   CC15 3E 06       			ld a,6			//clear place
1490   CC17 21 3B 4A    			ld hl, 16384+2048+32+512+27
1491   CC1A 11 3C 4A    			ld de, 16384+2048+32+512+27+1
1492   CC1D 01 04 00    			ld bc,4
1493   CC20 36 00       1B			ld (hl),0
1494   CC22 C5          			push bc
1495   CC23 ED B0       			ldir
1496   CC25 C1          			pop bc
1497   CC26 ED 42       			sbc hl,bc
1498   CC28 24          			inc h
1499   CC29 54          			ld d,h
1500   CC2A 5D          			ld e,l
1501   CC2B 1C          			inc e
1502   CC2C 3D          			dec a
1503   CC2D 20 F1       			jr nz, 1B
1504   CC2F             
1505   CC2F             //			ld a,2
1506   CC2F             //			out (254),a
1507   CC2F             
1508   CC2F 01 D8 49    			ld	bc,#49D8	//print clock
1509   CC32 ED 43 1F CF 			ld	(txy51.cursor),bc	
1510   CC36 21 65 CC    			ld hl,clockbuff3
1511   CC39 CD 7B CE    			call txy51.txy
1512   CC3C             //			ld a,3
1513   CC3C             //			out (254),a
1514   CC3C 01 90 49    			ld	bc,#4990
1515   CC3F ED 43 1F CF 			ld	(txy51.cursor),bc			
1516   CC43 21 57 CC    			ld hl,clockbuff
1517   CC46 CD 7B CE    			call txy51.txy
1518   CC49             //			ld a,4
1519   CC49             //			out (254),a
1520   CC49 01 C5 49    			ld	bc,#49C5
1521   CC4C ED 43 1F CF 			ld	(txy51.cursor),bc			
1522   CC50 21 61 CC    			ld hl,clockbuff2
1523   CC53 CD 7B CE    			call txy51.txy
1524   CC56             			
1525   CC56 C9          			ret
1526   CC57             clockbuff	dc "22/05/2073" 
1526   CC57 32322F30352F323037B3
1527   CC61 54 75 65 A0 clockbuff2	dc "Tue "
1528   CC65             clockbuff3	dc "16:33:26"
1528   CC65 31363A33333A32B6
1529   CC6D 53 75 6E A0 weekdays	dc "Sun "
1530   CC71 4D 6F 6E A0 			dc "Mon "
1531   CC75 54 75 65 A0 			dc "Tue "
1532   CC79 57 65 64 A0 			dc "Wed "
1533   CC7D 54 68 75 A0 			dc "Thu "
1534   CC81 46 72 69 A0 			dc "Fri "
1535   CC85 53 61 74 A0 			dc "Sat "
1536   CC89             
1537   CC89 3E 07       clean		ld a,7			//clear place
1538   CC8B 21 20 49    			ld hl, 16384+2048+32+256+0
1539   CC8E 11 21 49    			ld de, 16384+2048+32+256+0+1
1540   CC91 01 DF 00    			ld bc,255-32
1541   CC94 36 00       1B			ld (hl),0
1542   CC96 C5          			push bc
1543   CC97 ED B0       			ldir
1544   CC99 C1          			pop bc
1545   CC9A ED 42       			sbc hl,bc
1546   CC9C 24          			inc h
1547   CC9D 54          			ld d,h
1548   CC9E 5D          			ld e,l
1549   CC9F 1C          			inc e
1550   CCA0 3D          			dec a
1551   CCA1 20 F1       			jr nz, 1B
1552   CCA3 21 40 48    			ld hl, 16384+2048+64+0
1553   CCA6 11 41 48    			ld de, 16384+2048+64+0+1
1554   CCA9 01 BF 00    			ld bc,255-64
1555   CCAC 36 00       			ld (hl),0
1556   CCAE ED B0       			ldir
1557   CCB0 21 00 50    			ld hl, 16384+4096
1558   CCB3 11 01 50    			ld de, 16384+4096+1
1559   CCB6 01 FF 07    			ld bc,2047
1560   CCB9 75          			ld (hl),l
1561   CCBA ED B0       			ldir					
1562   CCBC C9          			ret	
1563   CCBD             ; --------------- L I B R A R I E S ---------------------------------------	
1564   CCBD             	
1565   CCBD             //INCLUDE "nasobeniHLDE.a80"
1566   CCBD             	INCLUDE "draw-jugo.a80"
0001+  CCBD             ;rutina na kresleni cary. pochazi z nejakeho jugoslavskeho casaku
0002+  CCBD             ;BC-ODKUD DE-KAM NAKRESLI CARU
0003+  CCBD             ;POCATEK VLEVO NAHORE (0,0)
0004+  CCBD             	module draw_jugo
0005+  CCBD 7A          DRAW     LD   A,D
0006+  CCBE FE C0                CP   192
0007+  CCC0 D0                   RET  NC
0008+  CCC1 78                   LD   A,B
0009+  CCC2 FE C0                CP   192
0010+  CCC4 D0                   RET  NC
0011+  CCC5 3F                   CCF
0012+  CCC6 1F                   RRA
0013+  CCC7 37                   SCF
0014+  CCC8 1F                   RRA
0015+  CCC9 A7                   AND  A
0016+  CCCA 1F                   RRA
0017+  CCCB A8                   XOR  B
0018+  CCCC E6 F8                AND  248
0019+  CCCE A8                   XOR  B
0020+  CCCF 67                   LD   H,A
0021+  CCD0 79                   LD   A,C
0022+  CCD1 07                   RLCA
0023+  CCD2 07                   RLCA
0024+  CCD3 07                   RLCA
0025+  CCD4 6F                   LD   L,A
0026+  CCD5 E6 38                AND  56
0027+  CCD7 2F                   CPL
0028+  CCD8 32 DD CC             LD   (LAB+1),A
0029+  CCDB AF                   XOR  A
0030+  CCDC CB C7       LAB      SET  0,A
0031+  CCDE 08                   EX   AF,AF'
0032+  CCDF 7D                   LD   A,L
0033+  CCE0 A8                   XOR  B
0034+  CCE1 E6 C7                AND  199
0035+  CCE3 A8                   XOR  B
0036+  CCE4 07                   RLCA
0037+  CCE5 07                   RLCA
0038+  CCE6 6F                   LD   L,A
0039+  CCE7 78                   LD   A,B
0040+  CCE8 92                   SUB  D
0041+  CCE9 06 00                LD   B,0
0042+  CCEB 30 03                JR   NC,N1
0043+  CCED ED 44                NEG
0044+  CCEF 04                   INC  B
0045+  CCF0 57          N1       LD   D,A
0046+  CCF1 79                   LD   A,C
0047+  CCF2 93                   SUB  E
0048+  CCF3 0E 00                LD   C,0
0049+  CCF5 30 03                JR   NC,N2
0050+  CCF7 ED 44                NEG
0051+  CCF9 0C                   INC  C
0052+  CCFA 5F          N2       LD   E,A
0053+  CCFB 08                   EX   AF,AF'
0054+  CCFC F5                   PUSH AF
0055+  CCFD B6                   OR   (HL)
0056+  CCFE 77                   LD   (HL),A
0057+  CCFF F1                   POP  AF
0058+  CD00 08                   EX   AF,AF'
0059+  CD01 B2                   OR   D
0060+  CD02 C8                   RET  Z
0061+  CD03 E5                   PUSH HL
0062+  CD04 7A                   LD   A,D
0063+  CD05 BB                   CP   E
0064+  CD06 38 37                JR   C,POX
0065+  CD08 21 63 CD             LD   HL,LEVO
0066+  CD0B CB 41                BIT  0,C
0067+  CD0D 28 03                JR   Z,Y1
0068+  CD0F 21 5E CD             LD   HL,DESNO
0069+  CD12 22 32 CD    Y1       LD   (DIA+1),HL
0070+  CD15 21 7B CD             LD   HL,GORE
0071+  CD18 CB 40                BIT  0,B
0072+  CD1A 28 03                JR   Z,Y2
0073+  CD1C 21 68 CD             LD   HL,DOLE
0074+  CD1F 22 35 CD    Y2       LD   (NAST+1),HL
0075+  CD22 4A                   LD   C,D
0076+  CD23 CB 39       N3       SRL  C
0077+  CD25 DD 62                LD   HX,D
0078+  CD27 08                   EX   AF,AF'
0079+  CD28 47                   LD   B,A
0080+  CD29 E1                   POP  HL
0081+  CD2A 79          LOOP     LD   A,C
0082+  CD2B 93                   SUB  E
0083+  CD2C 4F                   LD   C,A
0084+  CD2D 30 05                JR   NC,NAST
0085+  CD2F 82                   ADD  A,D
0086+  CD30 4F                   LD   C,A
0087+  CD31 CD 00 00    DIA      CALL 0
0088+  CD34 CD 00 00    NAST     CALL 0
0089+  CD37 78                   LD   A,B
0090+  CD38 B6                   OR   (HL)
0091+  CD39 77                   LD   (HL),A
0092+  CD3A DD 25                DEC  HX
0093+  CD3C 20 EC                JR   NZ,LOOP
0094+  CD3E C9                   RET
0095+  CD3F 21 63 CD    POX      LD   HL,LEVO
0096+  CD42 CB 41                BIT  0,C
0097+  CD44 28 03                JR   Z,X1
0098+  CD46 21 5E CD             LD   HL,DESNO
0099+  CD49 22 35 CD    X1       LD   (NAST+1),HL
0100+  CD4C 21 7B CD             LD   HL,GORE
0101+  CD4F CB 40                BIT  0,B
0102+  CD51 28 03                JR   Z,X2
0103+  CD53 21 68 CD             LD   HL,DOLE
0104+  CD56 22 32 CD    X2       LD   (DIA+1),HL
0105+  CD59 4B                   LD   C,E
0106+  CD5A 5A                   LD   E,D
0107+  CD5B 51                   LD   D,C
0108+  CD5C 18 C5                JR   N3
0109+  CD5E CB 08       DESNO    RRC  B
0110+  CD60 D0                   RET  NC
0111+  CD61 23                   INC  HL
0112+  CD62 C9                   RET
0113+  CD63 CB 00       LEVO     RLC  B
0114+  CD65 D0                   RET  NC
0115+  CD66 2B                   DEC  HL
0116+  CD67 C9                   RET
0117+  CD68 24          DOLE     INC  H
0118+  CD69 7C                   LD   A,H
0119+  CD6A E6 07                AND  7
0120+  CD6C C0                   RET  NZ
0121+  CD6D 7C                   LD   A,H
0122+  CD6E D6 08                SUB  8
0123+  CD70 67                   LD   H,A
0124+  CD71 7D                   LD   A,L
0125+  CD72 C6 20                ADD  A,32
0126+  CD74 6F                   LD   L,A
0127+  CD75 D0                   RET  NC
0128+  CD76 7C                   LD   A,H
0129+  CD77 C6 08                ADD  A,8
0130+  CD79 67                   LD   H,A
0131+  CD7A C9                   RET
0132+  CD7B 25          GORE     DEC  H
0133+  CD7C 7C                   LD   A,H
0134+  CD7D 2F                   CPL
0135+  CD7E E6 07                AND  7
0136+  CD80 C0                   RET  NZ
0137+  CD81 7C                   LD   A,H
0138+  CD82 C6 08                ADD  A,8
0139+  CD84 67                   LD   H,A
0140+  CD85 7D                   LD   A,L
0141+  CD86 D6 20                SUB  32
0142+  CD88 6F                   LD   L,A
0143+  CD89 D0                   RET  NC
0144+  CD8A 7C                   LD   A,H
0145+  CD8B D6 08                SUB  8
0146+  CD8D 67                   LD   H,A
0147+  CD8E C9                   RET
0148+  CD8F             	endmodule
0149+  CD8F             
1567   CD8F             	INCLUDE "cls.a80"
0001+  CD8F             	module cls
0002+  CD8F             CLS     
0003+  CD8F AF                  xor  a
0004+  CD90 D3 FE               out  (254),a
0005+  CD92 21 FF 5A    		ld	hl, 5AFFh
0006+  CD95 11 FE 5A    		ld	de, 5AFEh
0007+  CD98 01 FF 1A    		ld	bc, 1AFFh
0008+  CD9B 77          		ld	(hl), a
0009+  CD9C ED B8       		lddr			; Clear	videoram (black	screen)
0010+  CD9E C9          		ret
0011+  CD9F                     
0012+  CD9F             	endmodule
1568   CD9F             	INCLUDE "iinkey.a80"
0001+  CD9F             	module iinkey
0002+  CD9F CD AC CD    ANYKEY   call IINKEY
0003+  CDA2 28 FB                jr   z,ANYKEY
0004+  CDA4 F5                   push af
0005+  CDA5 CD AC CD    ANYKEY_0 call IINKEY
0006+  CDA8 20 FB                jr   nz,ANYKEY_0
0007+  CDAA F1                   pop  af
0008+  CDAB C9                   ret
0009+  CDAC             ;------------------------------
0010+  CDAC E5          IINKEY   push hl
0011+  CDAD D5                   push de
0012+  CDAE C5                   push bc
0013+  CDAF 01 FE 7F             ld   bc,#7FFE
0014+  CDB2 26 00                ld   h,0
0015+  CDB4 54                   ld   d,h
0016+  CDB5 5C                   ld   e,h
0017+  CDB6 2E 05       II1      ld   l,5
0018+  CDB8 ED 78                in   a,(c)
0019+  CDBA 24          II2      inc  h
0020+  CDBB 0F                   rrca
0021+  CDBC 38 02                jr   c,II3
0022+  CDBE 53                   ld   d,e
0023+  CDBF 5C                   ld   e,h
0024+  CDC0 2D          II3      dec  l
0025+  CDC1 20 F7                jr   nz,II2
0026+  CDC3 CB 08                rrc  b
0027+  CDC5 38 EF                jr   c,II1
0028+  CDC7 7B                   ld   a,e
0029+  CDC8 FE 24                cp   #24
0030+  CDCA 20 03                jr   nz,II5
0031+  CDCC 5A                   ld   e,d
0032+  CDCD 16 24                ld   d,#24
0033+  CDCF FE 02       II5      cp   2
0034+  CDD1 20 03                jr   nz,II6
0035+  CDD3 5A                   ld   e,d
0036+  CDD4 16 02                ld   d,2
0037+  CDD6 21 F8 CD    II6      ld   hl,IINN
0038+  CDD9 AF                   xor  a
0039+  CDDA AA                   xor  d
0040+  CDDB 28 12                jr   z,II7
0041+  CDDD 21 4A CE             ld   hl,IISS
0042+  CDE0 FE 02                cp   2
0043+  CDE2 28 0B                jr   z,II7
0044+  CDE4 21 21 CE             ld   hl,IICS
0045+  CDE7 FE 24                cp   #24
0046+  CDE9 28 04                jr   z,II7
0047+  CDEB 3E 01                ld   a,1
0048+  CDED 18 04                jr   II8
0049+  CDEF             
0050+  CDEF 16 00       II7      ld   d,0
0051+  CDF1 19                   add  hl,de
0052+  CDF2 7E                   ld   a,(hl)
0053+  CDF3 A7          II8      and  a
0054+  CDF4 C1                   pop  bc
0055+  CDF5 D1                   pop  de
0056+  CDF6 E1                   pop  hl
0057+  CDF7 C9                   ret
0058+  CDF8             
0059+  CDF8 00 20 1C    IINN     defb 0," ",#1C
0060+  CDFB 6D 6E 62             defb "mnb"
0061+  CDFE 0D                   defb 13
0062+  CDFF 6C 6B 6A 68          defb "lkjh"
0063+  CE03 706F697579           defb "poiuy"
0064+  CE08 3039383736           defb "09876"
0065+  CE0D 3132333435           defb "12345"
0066+  CE12 7177657274           defb "qwert"
0067+  CE17 6173646667           defb "asdfg"
0068+  CE1C 00                   defb 0
0069+  CE1D 7A 78 63 76          defb "zxcv"
0070+  CE21             
0071+  CE21 00 11 0E    IICS     defb 0,#11,#0E
0072+  CE24 4D 4E 42             defb "MNB"
0073+  CE27 02                   defb 2
0074+  CE28 4C 4B 4A 48          defb "LKJH"
0075+  CE2C 504F495559           defb "POIUY"
0076+  CE31 0C0F090B0A           defb #0C,#0F,9,#0B,#0A
0077+  CE36 0706040508           defb 7,6,4,5,8
0078+  CE3B 5157455254           defb "QWERT"
0079+  CE40 4153444647           defb "ASDFG"
0080+  CE45 1F                   defb #1F
0081+  CE46 5A 58 43 56          defb "ZXCV"
0082+  CE4A             
0083+  CE4A 00 10 1E    IISS     defb 0,16,#1E
0084+  CE4D 2E 2C 2A             defb ".,*"
0085+  CE50 03                   defb 3
0086+  CE51 3D 2B 2D 5E          defb "=+-^"
0087+  CE55 22                   defb 34 ;"
0088+  CE56 3B 7F 7D 7B          defb ";}{"
0089+  CE5A 5F29282726           defb "_)('&"
0090+  CE5F 2140232425           defb "!@#$%"
0091+  CE64 12 13 14             defb #12,#13,#14
0092+  CE67 3C 3E                defb "<>"
0093+  CE69 7E 7C                defb "~|"
0094+  CE6B 5C                   defb 92 ;\
0095+  CE6C 7B                   defb 123 ;{
0096+  CE6D 7D                   defb 125 ;}
0097+  CE6E 1D                   defb #1D
0098+  CE6F 3A 60 3F 2F          defb ":`?/"
0099+  CE73             
0100+  CE73             	endmodule
1569   CE73             	INCLUDE "wait.a80"
0001+  CE73             	module wait
0002+  CE73             wait
0003+  CE73             //	ex (SP),IX
0004+  CE73             //	ex (SP),IX
0005+  CE73 2B          	dec hl
0006+  CE74 7C          	ld a,h
0007+  CE75 BD          	cp l
0008+  CE76 20 FB       	jr nz,wait
0009+  CE78 10 F9       	djnz wait
0010+  CE7A C9          	ret
0011+  CE7B             
0012+  CE7B             	endmodule
1570   CE7B             //	INCLUDE "t42.a80"
1571   CE7B             //	INCLUDE "txy.a80"
1572   CE7B             	INCLUDE "txy51.a80"
0001+  CE7B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0002+  CE7B             ; Poziciovy print 42*27 znakov ;
0003+  CE7B             ;  + znakovy subor 6*7 bodov   ;
0004+  CE7B             ; (vytvoreny pre disasembler)  ;
0005+  CE7B             ; . -28.05.1988- Busy software ;
0006+  CE7B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0007+  CE7B             ;DEMO:napiste:asm,dbg,rpp,g
0008+  CE7B             //Original by BusySoft
0009+  CE7B             	MODULE txy51
0010+  CE7B 7E          txy	 	 ld   a,(hl)
0011+  CE7C E6 7F                and  127
0012+  CE7E             /*         cp   13
0013+  CE7E                      jr   z,T42_ZMEN */
0014+  CE7E FE 10                cp   16
0015+  CE80 28 0B                jr	  z,colorchange
0016+  CE82 E5                   push hl
0017+  CE83 CD 95 CE             call xy
0018+  CE86 E1                   pop  hl
0019+  CE87             /*         ld   a,(T42_BORE)
0020+  CE87~                     dec  a
0021+  CE87~                     cp   c
0022+  CE87~                     jr   c,T42_ZMEN
0023+  CE87                      inc  c */
0024+  CE87 7E          T42_BACK ld   a,(hl)
0025+  CE88 17                   rla
0026+  CE89 D8                   ret  c
0027+  CE8A 23                   inc  hl
0028+  CE8B 18 EE                jr   txy
0029+  CE8D             
0030+  CE8D             colorchange
0031+  CE8D 23          			inc hl
0032+  CE8E 7E          			ld a,(hl)
0033+  CE8F 32 94 CE    			ld (T42_ATT),a
0034+  CE92 18 F3       			jr T42_BACK	
0035+  CE94 00          T42_ATT		defb 0	
0036+  CE95             
0037+  CE95             //exampleBusy
0038+  CE95             /*
0039+  CE95~            start	ld	hl,#4000
0040+  CE95~            	ld	de,#4001
0041+  CE95~            	ld	bc,#17ff
0042+  CE95~            	ld	(hl),#00
0043+  CE95~            	ldir
0044+  CE95~            	ld	hl,#0202
0045+  CE95~            	ld	(cursor),hl
0046+  CE95~            	ld	hl,text
0047+  CE95~            aaa	ld	a,(hl)
0048+  CE95~            	call	xy
0049+  CE95~            	inc	hl
0050+  CE95~            	jr	nz,aaa
0051+  CE95~            	ld	a,' '
0052+  CE95~            bbb	ld	b,a
0053+  CE95~            	call	xy
0054+  CE95~            	ld	a,b
0055+  CE95~            	inc	a
0056+  CE95~            	cp	#80
0057+  CE95~            	jr	c,bbb
0058+  CE95~            	ld	hl,#2758
0059+  CE95~            	exx
0060+  CE95~            	ret
0061+  CE95~            
0062+  CE95~            text	db	'*** Rutina print'
0063+  CE95~            		db	' 42*27 znakov v '
0064+  CE95~            		db	'obraze ***'
0065+  CE95~            		db	'        Priklad '
0066+  CE95~            		db	'vypisu:         '
0067+  CE95~            		db	'          '
0068+  CE95~            		db	#00
0069+  CE95             		*/
0070+  CE95             ;main code
0071+  CE95 A7          xy	and	a
0072+  CE96 C8          	ret	z
0073+  CE97 D9          	exx
0074+  CE98 ED 4B 1F CF 	ld	bc,(cursor)
0075+  CE9C 11 25 CF    xy8	ld	de,znaky
0076+  CE9F 26 00       	ld	h,#00
0077+  CEA1 6F          	ld	l,a
0078+  CEA2 29          	add	hl,hl
0079+  CEA3 29          	add	hl,hl
0080+  CEA4 29          	add	hl,hl
0081+  CEA5 19          	add	hl,de
0082+  CEA6 E5          	push	hl
0083+  CEA7 FD E1       	pop	iy
0084+  CEA9 DD 26 08    	ld	xh,#08
0085+  CEAC 78          xy8dd	ld	a,b
0086+  CEAD FE C0       	cp	#c0
0087+  CEAF 30 38       	jr	nc,xyend
0088+  CEB1             ;	call	#22b1
0089+  CEB1             
0090+  CEB1 A7          	and a
0091+  CEB2 1F          	rra
0092+  CEB3 37          	scf
0093+  CEB4 1F          	rra
0094+  CEB5 A7          	and a
0095+  CEB6 1F          	rra
0096+  CEB7 A8          	xor b
0097+  CEB8 E6 F8       	and 248
0098+  CEBA A8          	xor b
0099+  CEBB 67          	ld h,a
0100+  CEBC 79          	ld a,c
0101+  CEBD 07          	rlca
0102+  CEBE 07          	rlca
0103+  CEBF 07          	rlca
0104+  CEC0 A8          	xor b
0105+  CEC1 E6 C7       	and 199
0106+  CEC3 A8          	xor b
0107+  CEC4 07          	rlca
0108+  CEC5 07          	rlca
0109+  CEC6 6F          	ld l,a
0110+  CEC7 79          	ld a,c
0111+  CEC8 E6 07       	and 07
0112+  CECA             
0113+  CECA FD 56 00    	ld	d,(iy+#00)
0114+  CECD 1E 00       	ld	e,#00
0115+  CECF 28 07       	jr	z,xy8bb
0116+  CED1 CB 1A       xy8cc	rr	d
0117+  CED3 CB 1B       	rr	e
0118+  CED5 3D          	dec	a
0119+  CED6 20 F9       	jr	nz,xy8cc
0120+  CED8 7A          xy8bb	ld	a,d
0121+  CED9 B6          	or	(hl)
0122+  CEDA 77          	ld	(hl),a
0123+  CEDB 23          	inc	hl
0124+  CEDC 7B          	ld	a,e
0125+  CEDD B6          	or	(hl)
0126+  CEDE 77          	ld	(hl),a
0127+  CEDF 04          	inc	b
0128+  CEE0 FD 23       	inc	iy
0129+  CEE2 DD 25       	dec	xh
0130+  CEE4 20 C6       	jr	nz,xy8dd
0131+  CEE6 CD 07 CF    	call T51_COLOR
0132+  CEE9 DD 21 1B CF xyend	ld	ix,flag0
0133+  CEED DD 7E 04    	ld	a,(ix+#04)
0134+  CEF0 C6 05       	add	a,5
0135+  CEF2 DD 77 04    	ld	(ix+#04),a
0136+  CEF5 FE FD       	cp	256-3
0137+  CEF7 38 0C       	jr	c,xystop
0138+  CEF9 DD 36 04 02 	ld	(ix+#04),2
0139+  CEFD DD 7E 05    	ld	a,(ix+#05)
0140+  CF00 C6 07       	add	a,7
0141+  CF02 DD 77 05    	ld	(ix+#05),a
0142+  CF05 D9          xystop	exx
0143+  CF06 C9          	ret
0144+  CF07             
0145+  CF07             T51_COLOR
0146+  CF07 3A 94 CE    				ld a,(T42_ATT)
0147+  CF0A B7          				or a
0148+  CF0B C8          				ret z
0149+  CF0C             ; pokud je nula, tak se neobarvuje
0150+  CF0C             ;				dec h
0151+  CF0C 2D          				dec l
0152+  CF0D             
0153+  CF0D 7C          				ld a,h
0154+  CF0E 0F          				rrca
0155+  CF0F 0F          				rrca
0156+  CF10 0F          				rrca
0157+  CF11 E6 03       				and 3
0158+  CF13 F6 58       				or 88
0159+  CF15 67          				ld h,a
0160+  CF16 3A 94 CE    				ld a,(T42_ATT)
0161+  CF19 77          				ld (hl),a
0162+  CF1A C9          				ret
0163+  CF1B             ;systemove premenne:(pre disu)
0164+  CF1B             
0165+  CF1B 00          flag0	db	#00
0166+  CF1C 00          flag1	db	#00
0167+  CF1D 00          flag2	db	#00
0168+  CF1E 00          inp	db	#00
0169+  CF1F             
0170+  CF1F             cursor
0171+  CF1F 00          xxx	db	#00
0172+  CF20 00          yyy	db	#00
0173+  CF21 00 00       leni	dw	0
0174+  CF23 00 00       adr	dw	0
0175+  CF25             
0176+  CF25             znaky
0177+  CF25              INCBIN zx51.ch6
0178+  D725             
0179+  D725             	ENDMODULE
1573   D725             	INCLUDE "txy32.a80"
0001+  D725             //LMN128-Jan Kucera-Zlin/CZ
0002+  D725             //added OR Flag
0003+  D725             //Original by BusySoft
0004+  D725             	MODULE txy32
0005+  D725 7E          txy	 	 ld   a,(hl)
0006+  D726 E6 7F                and  127
0007+  D728             /*         cp   13
0008+  D728                      jr   z,T42_ZMEN */
0009+  D728 FE 10                cp   16
0010+  D72A 28 0B                jr	  z,colorchange
0011+  D72C E5                   push hl
0012+  D72D CD 3F D7             call xy
0013+  D730 E1                   pop  hl
0014+  D731             /*         ld   a,(T42_BORE)
0015+  D731~                     dec  a
0016+  D731~                     cp   c
0017+  D731~                     jr   c,T42_ZMEN
0018+  D731                      inc  c */
0019+  D731 7E          T32_BACK ld   a,(hl)
0020+  D732 17                   rla
0021+  D733 D8                   ret  c
0022+  D734 23                   inc  hl
0023+  D735 18 EE                jr   txy
0024+  D737             
0025+  D737             colorchange
0026+  D737 23          			inc hl
0027+  D738 7E          			ld a,(hl)
0028+  D739 32 3E D7    			ld (T32_ATT),a
0029+  D73C 18 F3       			jr T32_BACK	
0030+  D73E 00          T32_ATT		defb 0	
0031+  D73F             
0032+  D73F A7          xy	and	a
0033+  D740 C8          	ret	z
0034+  D741 D9          	exx
0035+  D742 ED 4B EB D7 	ld	bc,(cursor)
0036+  D746 11 25 CF    xy8	ld	de,boot.txy51.znaky
0037+  D749 26 00       	ld	h,#00
0038+  D74B 6F          	ld	l,a
0039+  D74C 29          	add	hl,hl
0040+  D74D 29          	add	hl,hl
0041+  D74E 29          	add	hl,hl
0042+  D74F 19          	add	hl,de
0043+  D750 E5          	push hl
0044+  D751 FD E1       	pop	iy
0045+  D753 DD 26 08    	ld	xh,#08
0046+  D756 78          xy8dd	ld	a,b
0047+  D757 FE C0       	cp	#c0
0048+  D759 30 48       	jr	nc,xyend
0049+  D75B             ;	call	#22b1
0050+  D75B             
0051+  D75B A7          	and a
0052+  D75C 1F          	rra
0053+  D75D 37          	scf
0054+  D75E 1F          	rra
0055+  D75F A7          	and a
0056+  D760 1F          	rra
0057+  D761 A8          	xor b
0058+  D762 E6 F8       	and 248
0059+  D764 A8          	xor b
0060+  D765 67          	ld h,a
0061+  D766 79          	ld a,c
0062+  D767 07          	rlca
0063+  D768 07          	rlca
0064+  D769 07          	rlca
0065+  D76A A8          	xor b
0066+  D76B E6 C7       	and 199
0067+  D76D A8          	xor b
0068+  D76E 07          	rlca
0069+  D76F 07          	rlca
0070+  D770 6F          	ld l,a
0071+  D771 79          	ld a,c
0072+  D772 E6 07       	and 07
0073+  D774             
0074+  D774 FD 56 00    	ld	d,(iy+#00)
0075+  D777             //	ld	e,#00
0076+  D777 28 48       	jr	z,xy8bbnew 		//kulata pozice, staci vypsat jen jeden atribut
0077+  D779 1E 00       	ld e,0
0078+  D77B CB 1A       xy8cc rr	d
0079+  D77D CB 1B       	rr	e
0080+  D77F 3D          	dec	a
0081+  D780 20 F9       	jr	nz,xy8cc   
0082+  D782             xy8bb
0083+  D782 3A F1 D7    	ld a,(orflag)
0084+  D785 A7          	and a
0085+  D786 7A          	ld a,d
0086+  D787 20 01       	jr nz,1F
0087+  D789 B6          	or	(hl)
0088+  D78A 77          1	ld	(hl),a
0089+  D78B CD D0 D7        call T32_COLOR
0090+  D78E 23          	inc	hl
0091+  D78F 3A F1 D7    	ld a,(orflag)
0092+  D792 A7          	and a
0093+  D793 7B          	ld a,e
0094+  D794 20 01       	jr nz,2F
0095+  D796 B6          	or	(hl)				
0096+  D797 77          2	ld	(hl),a
0097+  D798 CD D0 D7        call T32_COLOR
0098+  D79B 04          3	inc	b
0099+  D79C FD 23       	inc	iy
0100+  D79E DD 25       	dec	xh
0101+  D7A0             //    call T32_COLOR
0102+  D7A0 C2 56 D7    	jp	nz,xy8dd
0103+  D7A3             //	call T32_COLOR
0104+  D7A3 DD 21 E7 D7 xyend	ld	ix,flag0
0105+  D7A7 DD 7E 04    	ld	a,(ix+#04)
0106+  D7AA C6 08       	add	a,8
0107+  D7AC DD 77 04    	ld	(ix+#04),a
0108+  D7AF FE F9       	cp	256-7
0109+  D7B1 38 0C       	jr	c,xystop
0110+  D7B3 DD 36 04 02 	ld	(ix+#04),2
0111+  D7B7 DD 7E 05    	ld	a,(ix+#05)
0112+  D7BA C6 08       	add	a,8
0113+  D7BC DD 77 05    	ld	(ix+#05),a
0114+  D7BF D9          xystop	exx
0115+  D7C0 C9          	ret
0116+  D7C1             xy8bbnew
0117+  D7C1 3A F1 D7    	ld a,(orflag)
0118+  D7C4 A7          	and a
0119+  D7C5 7A          	ld a,d
0120+  D7C6 20 01       	jr nz,4F
0121+  D7C8 B6          	or (hl)
0122+  D7C9 77          4	ld (hl),a
0123+  D7CA CD D0 D7        call T32_COLOR
0124+  D7CD 23          	inc hl
0125+  D7CE 18 CB       	jr 3B
0126+  D7D0             	
0127+  D7D0 F5          T32_COLOR		push af
0128+  D7D1 3A 3E D7    				ld a,(T32_ATT)
0129+  D7D4 B7          				or a
0130+  D7D5 C8          				ret z
0131+  D7D6 E5          				push hl
0132+  D7D7             ; pokud je nula, tak se neobarvuje
0133+  D7D7             
0134+  D7D7             //				inc h
0135+  D7D7             //				inc l
0136+  D7D7             
0137+  D7D7 7C          				ld a,h
0138+  D7D8 0F          				rrca
0139+  D7D9 0F          				rrca
0140+  D7DA 0F          				rrca
0141+  D7DB E6 03       				and 3
0142+  D7DD F6 58       				or 88
0143+  D7DF 67          				ld h,a
0144+  D7E0 3A 3E D7    				ld a,(T32_ATT)
0145+  D7E3 77          				ld (hl),a
0146+  D7E4 E1          				pop hl
0147+  D7E5 F1          				pop af
0148+  D7E6 C9          				ret
0149+  D7E7             ;systemove premenne:(pre disu)
0150+  D7E7             
0151+  D7E7 00          flag0	db	#00
0152+  D7E8 00          flag1	db	#00
0153+  D7E9 00          flag2	db	#00
0154+  D7EA 00          inp	db	#00
0155+  D7EB             
0156+  D7EB             cursor
0157+  D7EB 00          xxx	db	#00
0158+  D7EC 00          yyy	db	#00
0159+  D7ED 00 00       leni	dw	0
0160+  D7EF 00 00       adr	dw	0
0161+  D7F1             
0162+  D7F1             
0163+  D7F1 01          orflag  db  #01
0164+  D7F2             //znaky
0165+  D7F2             // INCBIN zx51.ch6
0166+  D7F2             
0167+  D7F2             	ENDMODULE
1574   D7F2             	INCLUDE "sprite2.a80"
0001+  D7F2             ; zobrazi sprite dle cisla v A pozice a data spritu jsou v tabulce na adrese HL; priklad nakonci!!!
0002+  D7F2             ; nebo DE-pozice, HL-adresa (rutina OK)
0003+  D7F2             ; zobrazuje sprites z programu SpriteEdit typ 2
0004+  D7F2             	module sprite2
0005+  D7F2             SP_      
0006+  D7F2             ;        ld   hl,SP_TAB
0007+  D7F2 87                   add  a,a
0008+  D7F3 87                   add  a,a
0009+  D7F4 16 00                ld   d,0
0010+  D7F6 5F                   ld   e,a
0011+  D7F7 19                   add  hl,de
0012+  D7F8 5E                   ld   e,(hl)
0013+  D7F9 23                   inc  hl
0014+  D7FA 56                   ld   d,(hl)
0015+  D7FB 23                   inc  hl
0016+  D7FC D5             			 push de
0017+  D7FD 5E                   ld   e,(hl)
0018+  D7FE 23                   inc  hl
0019+  D7FF 56                   ld   d,(hl)
0020+  D800 EB                   ex   de,hl
0021+  D801 D1                   pop de
0022+  D802                      
0023+  D802             
0024+  D802             ;------------------------------
0025+  D802             OK       
0026+  D802 46                    ld b,(hl)
0027+  D803 23          					inc hl
0028+  D804 4E                    ld c,(hl)
0029+  D805 23                    inc hl
0030+  D806 7A                   ld   a,d
0031+  D807 0F                   rrca
0032+  D808 0F                   rrca
0033+  D809 0F                   rrca
0034+  D80A E6 E0                and  %11100000
0035+  D80C 83                   add  a,e
0036+  D80D 5F                   ld   e,a
0037+  D80E 7A                   ld   a,d
0038+  D80F E6 18                and  24
0039+  D811 F6 40                or   64
0040+  D813 57                   ld   d,a
0041+  D814             
0042+  D814 D5          OK_SEM   push de
0043+  D815 C5                   push bc
0044+  D816 7A                   ld   a,d
0045+  D817 0F                   rrca
0046+  D818 0F                   rrca
0047+  D819 0F                   rrca
0048+  D81A E6 03                and  3
0049+  D81C F6 58                or   88
0050+  D81E 57                   ld   d,a
0051+  D81F             
0052+  D81F             OK_RADE1 ;call DE_BAJT
0053+  D81F 7E                    ld a,(hl)
0054+  D820 23                    inc hl
0055+  D821             
0056+  D821 12                   ld   (de),a
0057+  D822 1C                   inc  e
0058+  D823 0D                   dec  c
0059+  D824 20 F9                jr   nz,OK_RADE1
0060+  D826 C1                   pop  bc
0061+  D827 D1                   pop  de
0062+  D828             
0063+  D828 D5          OK_DALSI push de
0064+  D829 C5                   push bc
0065+  D82A             OK_RADEK ;call DE_BAJT
0066+  D82A 7E                    ld a,(hl)
0067+  D82B 23                    inc hl
0068+  D82C             
0069+  D82C 12                   ld   (de),a
0070+  D82D 1C                   inc  e
0071+  D82E 0D                   dec  c
0072+  D82F 20 F9                jr   nz,OK_RADEK
0073+  D831 C1                   pop  bc
0074+  D832 D1                   pop  de
0075+  D833 14                   inc  d
0076+  D834 7A                   ld   a,d
0077+  D835 E6 07                and  7
0078+  D837 20 EF                jr   nz,OK_DALSI
0079+  D839 3E 20                ld   a,32
0080+  D83B 83                   add  a,e
0081+  D83C 5F                   ld   e,a
0082+  D83D 3F                   ccf
0083+  D83E 9F                   sbc  a,a
0084+  D83F E6 F8                and  -8
0085+  D841 82                   add  a,d
0086+  D842 57                   ld   d,a
0087+  D843 10 CF                djnz OK_SEM
0088+  D845 C9                   ret
0089+  D846             
0090+  D846             /*
0091+  D846~            SP_TAB   defw #0B00  ;kam zobrazit
0092+  D846~                     defw 32768 ;odkud
0093+  D846~            
0094+  D846~            
0095+  D846             */
0096+  D846             	endmodule
1575   D846             	INCLUDE "xdec_06.a80"
0001+  D846             //Original by BusySoft
0002+  D846             	MODULE xdec_06
0003+  D846             ;Prevod bin->dec bez znamienka
0004+  D846             ; in: bin
0005+  D846             ;out: dec
0006+  D846             z 
0007+  D846 21 F8 D8    bindec      ld   hl,zzdec            ;Vynulovanie buffera dec
0008+  D849 01 00 0A                ld   bc,lldec*#0100
0009+  D84C 71          cls1        ld   (hl),c
0010+  D84D 23                      inc  hl
0011+  D84E 10 FC                   djnz cls1
0012+  D850 0E 20                   ld   c,8*llbin           ;Opakuj pre kazdy bit bin:
0013+  D852 CD B9 D8    bndc0       call binx2               ;vyrotovanie bitu z bin
0014+  D855 21 02 D9                ld   hl,eedec
0015+  D858 06 0A                   ld   b,lldec             ;a zarotovanie toho bitu do dec
0016+  D85A 2B          bndc2       dec  hl
0017+  D85B 7E                      ld   a,(hl)
0018+  D85C 8F                      adc  a,a
0019+  D85D FE 0A                   cp   #0a
0020+  D85F 38 02                   jr   c,bndc3
0021+  D861 D6 0A                   sub  #0a
0022+  D863 77          bndc3       ld   (hl),a
0023+  D864 3F                      ccf
0024+  D865 10 F3                   djnz bndc2
0025+  D867 0D                      dec  c
0026+  D868 20 E8                   jr   nz,bndc0
0027+  D86A C9                      ret
0028+  D86B             
0029+  D86B             ;Prevod dec->bin bez znamienka
0030+  D86B             ; in: dec
0031+  D86B             ;out: bin
0032+  D86B              
0033+  D86B 21 F3 D8    decbin      ld   hl,zzbin           ; Vynulovanie bin
0034+  D86E 01 00 04                ld   bc,llbin*#0100
0035+  D871 71          cls2        ld   (hl),c
0036+  D872 23                      inc  hl
0037+  D873 10 FC                   djnz cls2                ;Vynasobenie bin desiatimi,
0038+  D875 DD 21 F8 D8             ld   ix,zzdec            ;a to takto:
0039+  D879 0E 0A                   ld   c,lldec             ;Najprv to vynasobime dvomi
0040+  D87B CD B9 D8    dcbn0       call binx2
0041+  D87E 21 F3 D8                ld   hl,zzbin
0042+  D881 11 02 D9                ld   de,zzbuf            ;Potom to presunieme
0043+  D884 06 04                   ld   b,llbin             ;do pomocneho buffera
0044+  D886 7E          dcbn1       ld   a,(hl)
0045+  D887 12                      ld   (de),a
0046+  D888 23                      inc  hl
0047+  D889 13                      inc  de
0048+  D88A 10 FA                   djnz dcbn1
0049+  D88C CD B9 D8                call binx2               ;Vynasobime styrmi
0050+  D88F CD B9 D8                call binx2               ;(cize dva krat dvomi)
0051+  D892 21 F3 D8                ld   hl,zzbin
0052+  D895 11 02 D9                ld   de,zzbuf
0053+  D898 06 04                   ld   b,llbin             ;A potom k tomu pripocitame
0054+  D89A AF                      xor  a                   ;to z pomocneho buffera
0055+  D89B 1A          dcbn2       ld   a,(de)
0056+  D89C 8E                      adc  a,(hl)
0057+  D89D 77                      ld   (hl),a
0058+  D89E 13                      inc  de
0059+  D89F 23                      inc  hl
0060+  D8A0 10 F9                   djnz dcbn2               ;A je to.
0061+  D8A2 21 F3 D8                ld   hl,zzbin
0062+  D8A5 06 03                   ld   b,llbin-1           ;Este pripocitame
0063+  D8A7 DD 7E 00                ld   a,(ix+#00)          ;jednu cislicu z dec
0064+  D8AA 86                      add  a,(hl)
0065+  D8AB 77                      ld   (hl),a
0066+  D8AC 23          dcbn3       inc  hl
0067+  D8AD 3E 00                   ld   a,#00
0068+  D8AF 8E                      adc  a,(hl)
0069+  D8B0 77                      ld   (hl),a
0070+  D8B1 10 F9                   djnz dcbn3
0071+  D8B3 DD 23                   inc  ix
0072+  D8B5 0D                      dec  c                   ;a opakujeme pre
0073+  D8B6 20 C3                   jr   nz,dcbn0            ;kazdu cislicu z dec
0074+  D8B8 C9                      ret
0075+  D8B9              
0076+  D8B9             ;Nejake podprogramy
0077+  D8B9              
0078+  D8B9 21 F3 D8    binx2       ld   hl,zzbin            ;Nasobenie bin dvomi
0079+  D8BC 06 04                   ld   b,llbin
0080+  D8BE AF                      xor  a
0081+  D8BF CB 16       bnxx2       rl   (hl)
0082+  D8C1 23                      inc  hl
0083+  D8C2 10 FB                   djnz bnxx2
0084+  D8C4 C9                      ret
0085+  D8C5             
0086+  D8C5 21 F3 D8    binneg      ld   hl,zzbin            ;Negacia bin
0087+  D8C8 06 04                   ld   b,llbin
0088+  D8CA 37                      scf
0089+  D8CB 7E          bnngx       ld   a,(hl)
0090+  D8CC 2F                      cpl
0091+  D8CD CE 00                   adc  a,#00
0092+  D8CF 77                      ld   (hl),a
0093+  D8D0 23                      inc  hl
0094+  D8D1 10 F8                   djnz bnngx
0095+  D8D3 C9                      ret
0096+  D8D4              
0097+  D8D4             ;Prevod bin-dec so znamienkom
0098+  D8D4             ; in: bin v doplnkovom formate
0099+  D8D4             ;out: dec + znamienko
0100+  D8D4              
0101+  D8D4 3A F6 D8    zbndec      ld   a,(eebin-1)
0102+  D8D7 CB 7F                   bit  7,a                 ;znamienkovy bit
0103+  D8D9 3E 2B                   ld   a,'+'
0104+  D8DB 28 05                   jr   z,zbn1
0105+  D8DD CD C5 D8                call binneg
0106+  D8E0 3E 2D                   ld   a,'-'
0107+  D8E2 32 F7 D8    zbn1        ld   (sign),a            ;zapis znamienka
0108+  D8E5 C3 46 D8                jp   bindec
0109+  D8E8              
0110+  D8E8             ;Prevod dec->bin so znamienkom
0111+  D8E8             ; in: dec + znamienko
0112+  D8E8             ;out: bin v doplnkovom formate
0113+  D8E8              
0114+  D8E8 CD 6B D8    zdcbin      call decbin
0115+  D8EB 3A F7 D8                ld   a,(sign)
0116+  D8EE FE 2D                   cp   '-'                 ;Ak to nie minus,
0117+  D8F0 C0                      ret  nz                  ;tak nic
0118+  D8F1 18 D2                   jr   binneg              ;ak je minus, tak negacia
0119+  D8F3              
0120+  D8F3             k
0121+  D8F3             l      =    k-z
0122+  D8F3             ;       org  #6000
0123+  D8F3              
0124+  D8F3             ;Buffery systemu - pre ulozenie vstupov a vystupov rutiniek
0125+  D8F3              
0126+  D8F3             ;BIN ... binarna hodnota cisla
0127+  D8F3             ;        najprv ide nizsi bajt
0128+  D8F3             ;        a po nom vyssie bajty
0129+  D8F3              
0130+  D8F3 FF FF FF FF zzbin  db   #ff,#ff,#ff,#ff
0131+  D8F7             eebin
0132+  D8F7             llbin  =    eebin-zzbin
0133+  D8F7              
0134+  D8F7             ;DEC ... postupnost desiatkovych cislic
0135+  D8F7             ;        najprv idu najvyssie rady
0136+  D8F7             ;        a po nich nizsie desiatkove rady
0137+  D8F7             ; Dlzka buffera musi byt taka aby sa do nej mestilo cislo z bin
0138+  D8F7             ; V pripade prevodov so znamienkom sa pouziva aj znamienko
0139+  D8F7              
0140+  D8F7 2B          sign   db   '+'
0141+  D8F8 0000000000  zzdec  db   0,0,0,0,0
0142+  D8FD              
0143+  D8FD 0605050305         db   6,5,5,3,5
0144+  D902              
0145+  D902             eedec
0146+  D902             lldec  =    eedec-zzdec
0147+  D902              
0148+  D902             ;Pomocny buffer pouzity pre nasobenie desiatimi,
0149+  D902             ;struktura dat taka ista ako BIN
0150+  D902              
0151+  D902 55 55 55 55 zzbuf  db   #55,#55,#55,#55
0152+  D906             eebuf
0153+  D906             	ENDMODULE
1576   D906             	INCLUDE "cf.a80"
0001+  D906               MODULE cf
0002+  D906             // output
0003+  D906             // A - error number  - Z - OK
0004+  D906             // HL - text of error
0005+  D906             // IX	- 512 bytes of indentify data; examples below
0006+  D906             
0007+  D906 DD 21 1C DA IDENT    ld   ix,BUFFER
0008+  D90A AF                   xor a              //only master
0009+  D90B             ;         ld   a,%00000000
0010+  D90B CD 94 D9             call IDENTIFY       
0011+  D90E             
0012+  D90E 21 86 D9             ld   hl,TEXT16
0013+  D911 F5                   push af			
0014+  D912 28 22                jr   z,TISKSTATUS1 ; OK
0015+  D914 21 38 D9             ld   hl,TEXT11
0016+  D917 FE FF                cp   255
0017+  D919 CA 36 D9             jp   z,TISKSTATUS1
0018+  D91C 21 66 D9             ld   hl,TEXT14
0019+  D91F FE 06                cp   6
0020+  D921 CA 36 D9             jp   z,TISKSTATUS1
0021+  D924 21 5A D9             ld   hl,TEXT13
0022+  D927 FE 03                cp   3
0023+  D929 CA 36 D9             jp   z,TISKSTATUS1
0024+  D92C 21 48 D9             ld   hl,TEXT12
0025+  D92F 3D                   dec  a
0026+  D930 CA 36 D9             jp   z,TISKSTATUS1
0027+  D933 21 78 D9             ld   hl,TEXT15         
0028+  D936 F1          TISKSTATUS1  pop  af
0029+  D937                    
0030+  D937             // A - error number
0031+  D937             // HL - text of error				
0032+  D937             /* examples
0033+  D937~            MASTERINFO
0034+  D937~                     ld   hl,TEXT4
0035+  D937~                     ld   bc,#0602
0036+  D937~                     call T42_TEXT
0037+  D937~                     ld   hl,TEXT5
0038+  D937~                     ld   bc,#0702
0039+  D937~                     call T42_TEXT
0040+  D937~                     ld   hl,TEXT6
0041+  D937~                     ld   bc,#0802
0042+  D937~                     call T42_TEXT
0043+  D937~                     ld   hl,TEXT7
0044+  D937~                     ld   bc,#0902
0045+  D937~                     call T42_TEXT
0046+  D937~                     ld   hl,TEXT101
0047+  D937~                     ld   bc,#0A02
0048+  D937~                     call T42_TEXT
0049+  D937~                     ld   hl,TEXT102
0050+  D937~                     ld   bc,#0A15
0051+  D937~                     call T42_TEXT
0052+  D937~            
0053+  D937~            ;model
0054+  D937~                     ld   hl,BUFFER+54
0055+  D937~                     ld   b,40
0056+  D937~                     call PROHOD
0057+  D937~                     set  7,(ix+84)
0058+  D937~            
0059+  D937~                     ld   bc,#0609
0060+  D937~                     call T42_TEXT
0061+  D937~            
0062+  D937~            ;firmware
0063+  D937~                     ld   hl,BUFFER+46
0064+  D937~                     ld   b,8
0065+  D937~                     call PROHOD
0066+  D937~                     set  7,(ix+53)
0067+  D937~            
0068+  D937~                     ld   bc,#070C
0069+  D937~                     call T42_TEXT
0070+  D937~            
0071+  D937~            ;serial number
0072+  D937~            
0073+  D937~                     ld   hl,BUFFER+20
0074+  D937~                     ld   b,20
0075+  D937~                     call PROHOD
0076+  D937~                     set  7,(ix+39)
0077+  D937~            
0078+  D937~                     ld   bc,#0811
0079+  D937~                     call T42_TEXT
0080+  D937~                     
0081+  D937~            
0082+  D937~                     
0083+  D937~            ;LBA
0084+  D937~                     ld   hl,TEXT_NO
0085+  D937~                     bit  1,(ix+99)
0086+  D937~                     jr   z,L1
0087+  D937~            
0088+  D937~                     ld   hl,TEXT_YES
0089+  D937~            L1       ld   bc,#090D
0090+  D937~                     call T42_TEXT
0091+  D937~            
0092+  D937~            ;DMA
0093+  D937~                     ld   hl,TEXT_NO
0094+  D937~                     bit  0,(ix+99)
0095+  D937~                     jr   z,L2
0096+  D937~            
0097+  D937~                     ld   hl,TEXT_YES
0098+  D937~            L2       ld   bc,#0925
0099+  D937~                     call T42_TEXT
0100+  D937~            
0101+  D937~            ;CHS
0102+  D937~            ;Cylinders
0103+  D937~            				 ld l,(ix+2)
0104+  D937~            				 ld h,(ix+3)
0105+  D937~                     ld   bc,#0A09
0106+  D937~                     call NUMBER4              
0107+  D937~            ;Heads         
0108+  D937~                     ld l,(ix+6)
0109+  D937~            				 ld h,(ix+7)
0110+  D937~                     ld   bc,#0A0f
0111+  D937~                     call NUMBER1
0112+  D937~            ;Sectors         
0113+  D937~                     ld l,(ix+12)
0114+  D937~            				 ld h,(ix+13)
0115+  D937~                     ld   bc,#0A12
0116+  D937~                     call NUMBER1
0117+  D937~                     
0118+  D937~            ;capacity                          
0119+  D937~            				 ld l,(ix+12)
0120+  D937~            				 ld h,(ix+13)
0121+  D937~                     ld e,(ix+6)
0122+  D937~            				 ld d,(ix+7)
0123+  D937~            				
0124+  D937~            				
0125+  D937~            				 push ix ; rutina nasob pouziva IX
0126+  D937~                     call nasobeniHLDE.nasob
0127+  D937~                     pop ix
0128+  D937~                     ld e,(ix+2)
0129+  D937~            				 ld d,(ix+3)
0130+  D937~            				 
0131+  D937~            				 push ix
0132+  D937~                     call nasobeniHLDE.nasob
0133+  D937~            ;vysledek je v IXHL
0134+  D937~            
0135+  D937~            				 ld l,h
0136+  D937~            				 ld a,xl
0137+  D937~            				 ld h,a
0138+  D937~            				 ld e,hx
0139+  D937~            
0140+  D937~            ;delime 256 vysledek EHL
0141+  D937~                     ld b,3
0142+  D937~            trikrat1 
0143+  D937~                     srl e
0144+  D937~                     rr h
0145+  D937~                     rr l
0146+  D937~                     djnz trikrat1				 
0147+  D937~            ;delime tremi
0148+  D937~                     ld   bc,#0A1F         
0149+  D937~                     call NUMBER4
0150+  D937~                     
0151+  D937~                     pop ix
0152+  D937~                     
0153+  D937~                     
0154+  D937~            ;LBA 48Bits
0155+  D937~            
0156+  D937~                     inc  hx
0157+  D937~            
0158+  D937~                     ld   hl,TEXT_NO
0159+  D937~                     bit  2,(ix-83)
0160+  D937~                     jr   z,L3
0161+  D937~            
0162+  D937~                     ld   hl,TEXT_YES
0163+  D937~            L3       ld   bc,#091C
0164+  D937~                     call T42_TEXT
0165+  D937~            
0166+  D937~            Endinentify
0167+  D937             */				
0168+  D937 C9                   ret
0169+  D938             ; navrat  
0170+  D938             ;------------------------------
0171+  D938             TEXT11   dc 16,7,"disk time out "
0171+  D938 10076469736B2074696D65206F7574A0
0172+  D948             TEXT12   dc 16,7,"status b0 error "
0172+  D948 1007737461747573206230206572726F72A0
0173+  D95A             TEXT13   dc 16,7,"DRQ error "
0173+  D95A 1007445251206572726F72A0
0174+  D966             TEXT14   dc 16,7,"drive not ready "
0174+  D966 10076472697665206E6F74207265616479A0
0175+  D978             TEXT15   dc 16,7,"other error "
0175+  D978 10076F74686572206572726F72A0
0176+  D986 10074F4B20  TEXT16   db 16,7,"OK "
0177+  D98B 10075965F3  TEXT_YES dc 16,7,"Yes"
0178+  D990 10 07 4E EF TEXT_NO  dc 16,7,"No"
0179+  D994             
0180+  D994             /*
0181+  D994~            ;------------------------------
0182+  D994~            ;TISK CISLA BC-POZICE HL-HODNOT
0183+  D994~            ;TISKNE CISLO TYPU INTEGER
0184+  D994~            ;STAR-RUTINA TISKU 1 ZNAKU NA
0185+  D994~            ;POZICI BC (0,0)
0186+  D994~            NUMBER4  ld   de,-10000
0187+  D994~                     call NUM_JED
0188+  D994~            NUMBER3  ld   de,-1000
0189+  D994~                     call NUM_JED
0190+  D994~            NUMBER2  ld   de,-100
0191+  D994~                     call NUM_JED
0192+  D994~            NUMBER1  ld   de,-10
0193+  D994~                     call NUM_JED
0194+  D994~            NUMBER0  ld   a,l
0195+  D994~                     add  a,48
0196+  D994~                     jp   T42
0197+  D994~            
0198+  D994~            NUM_JED  xor  a
0199+  D994~            NUM_JED1 add  hl,de
0200+  D994~                     jr   nc,NUM_PRIC
0201+  D994~                     inc  a
0202+  D994~                     jr   NUM_JED1
0203+  D994~            NUM_PRIC sbc  hl,de
0204+  D994~                     add  a,48
0205+  D994~                     push bc
0206+  D994~                     push hl
0207+  D994~                     call T42
0208+  D994~                     pop  hl
0209+  D994~                     pop  bc
0210+  D994~                     inc  c
0211+  D994~                     ret
0212+  D994             */
0213+  D994             ;------------------------------
0214+  D994             ;IDENTIFY:ix-adresa, a-mas/slv
0215+  D994             IDENTIFY
0216+  D994 F6 E0                or   %11100000
0217+  D996 32 9E D9             ld   (ACCMODE0+1),a
0218+  D999 CD B0 D9             call TST_BSY
0219+  D99C C0                   ret  nz
0220+  D99D             
0221+  D99D 3E 00       ACCMODE0 ld   a,0
0222+  D99F D3 DB                out  (P_HEA),a
0223+  D9A1 3E EC                ld   a,#EC
0224+  D9A3 D3 BF                out  (P_COM),a
0225+  D9A5 CD CA D9             call TST_DR
0226+  D9A8 C0                   ret  nz
0227+  D9A9             
0228+  D9A9 CD E6 D9             call RD_512
0229+  D9AC             
0230+  D9AC CD B0 D9             call TST_BSY
0231+  D9AF             ;
0232+  D9AF C9                   ret
0233+  D9B0             /*
0234+  D9B0~            ;fyzicke cteni jednoho LBA sectoru
0235+  D9B0~            ;ix=adresa, a=mod adresace bit4=master/slave
0236+  D9B0~            ;cedb= 28 bit lba sector;c-sectornumber,e-cylinderlow,d-cylinderhigh,b-head
0237+  D9B0~            LBAREAD
0238+  D9B0~                     or   %11100000
0239+  D9B0~            ;natvrdo LBA  bit6 urcuje, ze se pouzije LBA pristup        
0240+  D9B0~                     ld   (HEA_REG+1),a
0241+  D9B0~                     call TST_BSY
0242+  D9B0~                     ret  nz
0243+  D9B0~                     
0244+  D9B0~            HEA_REG  ld   a,%11100000
0245+  D9B0~            				 or  b
0246+  D9B0~            ; prictou se nejvyssi ctyri bity LBA				 
0247+  D9B0~                     out  (P_HEA),a
0248+  D9B0~            ;cislo hlavicky
0249+  D9B0~            
0250+  D9B0~                     ld   a,1
0251+  D9B0~                     out  (P_HSE),a
0252+  D9B0~            ;pocet sektoru 1*512B
0253+  D9B0~            
0254+  D9B0~                     ld   a,c
0255+  D9B0~                     out  (P_NSE),a
0256+  D9B0~            ;cislo sektoru od 1
0257+  D9B0~            
0258+  D9B0~                     ld   a,e
0259+  D9B0~                     out  (P_CYL),a
0260+  D9B0~                     ld   a,d
0261+  D9B0~                     out  (P_CYH),a
0262+  D9B0~            ;cislo cylindru
0263+  D9B0~            
0264+  D9B0~                     ld   a,#20
0265+  D9B0~                     out  (P_COM),a
0266+  D9B0~            
0267+  D9B0~            
0268+  D9B0~                     call TST_DR
0269+  D9B0~                     ret  nz
0270+  D9B0~            
0271+  D9B0~                     call RD_512
0272+  D9B0~                     call TST_BSY
0273+  D9B0~            ;         ret  nz
0274+  D9B0~            
0275+  D9B0                      ret*/
0276+  D9B0             
0277+  D9B0             TST_BSY
0278+  D9B0 E5                   push hl
0279+  D9B1 21 00 40             ld   hl,#4000 ;shorter timeout, was #0000
0280+  D9B4             TST1
0281+  D9B4 2B                   dec  hl
0282+  D9B5 7D                   ld   a,l
0283+  D9B6 B4                   or   h
0284+  D9B7 28 0C                jr   z,TOUT1
0285+  D9B9 DB BF       P84      in   a,(P_COM)
0286+  D9BB FE FF                cp   255
0287+  D9BD 28 F5                jr   z,TST1
0288+  D9BF CB 7F                bit  7,a
0289+  D9C1 20 F1                jr   nz,TST1
0290+  D9C3 E1                   pop  hl
0291+  D9C4 C9                   ret
0292+  D9C5             TOUT1
0293+  D9C5 3E FF                ld   a,255
0294+  D9C7 B7                   or   a
0295+  D9C8 E1                   pop  hl
0296+  D9C9 C9                   ret
0297+  D9CA             ;------------------------------
0298+  D9CA             ;test BSY,DRDY,DRQ,ERR statusu
0299+  D9CA             TST_DR
0300+  D9CA CD B0 D9             call TST_BSY
0301+  D9CD C0                   ret  nz
0302+  D9CE CB 77                bit  6,a
0303+  D9D0 28 09                jr   z,ER6
0304+  D9D2 CB 5F                bit  3,a
0305+  D9D4 28 09                jr   z,ER3
0306+  D9D6 CB 47                bit  0,a
0307+  D9D8 20 09                jr   nz,ER1
0308+  D9DA C9                   ret
0309+  D9DB 3E 07       ER6      ld   a,7
0310+  D9DD 3D                   dec  a
0311+  D9DE C9                   ret
0312+  D9DF 3E 04       ER3      ld   a,4
0313+  D9E1 3D                   dec  a
0314+  D9E2 C9                   ret
0315+  D9E3 3E 01       ER1      ld   a,1
0316+  D9E5 C9                   ret
0317+  D9E6             ;------------------------------
0318+  D9E6             RD_512
0319+  D9E6 DD 22 06 DA          ld   (DMADR1),ix
0320+  D9EA E5                   push hl
0321+  D9EB 21 FD D9             ld   hl,RD1S
0322+  D9EE 01 0B 0E             ld   bc,RD1L*256+DMA
0323+  D9F1 ED B3       RDWR1    otir
0324+  D9F3 06 87                ld   b,#87				;WR6 enable dma
0325+  D9F5 ED 41                out  (c),b
0326+  D9F7 E1                   pop  hl
0327+  D9F8 01 00 02             ld   bc,512
0328+  D9FB 09                   add  hl,bc
0329+  D9FC C9                   ret
0330+  D9FD             ;---<DMA_IN>-------------------
0331+  D9FD             RD1S
0332+  D9FD C3                   defb 195				;WR6 #C3 reset
0333+  D9FE 7D                   defb %01111101			;WR0 A->B, transfer
0334+  D9FF C3 00                defw P_DAT				;source port
0335+  DA01 FF 01                defw 511				;lenght
0336+  DA03 2C                   defb %00101100			;WR1 A-port,A-fixed
0337+  DA04 10                   defb %00010000			;WR2 B-memory, B-increment
0338+  DA05 AD                   defb %10101101			;WR4 continuous,
0339+  DA06 00 00       DMADR1   defw 0					;destination
0340+  DA08 92                   defb %10010010			;WR5 ready low,CE/WAIT,stop on end of block
0341+  DA09 CF                   defb #CF				;WR6 load
0342+  DA0A B3                   defb #B3				;WR6 force ready
0343+  DA0B             RD1L     equ  $-RD1S
0344+  DA0B             
0345+  DA0B             ;------------------------------
0346+  DA0B             ;prohazuje vyssi a nizsi byte
0347+  DA0B             ;zkurveny system
0348+  DA0B             PROHOD
0349+  DA0B             ;HL adresa
0350+  DA0B             ;B kolik bytu
0351+  DA0B             ;MENI: A
0352+  DA0B E5                   push hl
0353+  DA0C C5                   push bc
0354+  DA0D CB 08                rrc  b
0355+  DA0F             PROHOD1
0356+  DA0F 7E                   ld   a,(hl)
0357+  DA10 23                   inc  hl
0358+  DA11 4E                   ld   c,(hl)
0359+  DA12 2B                   dec  hl
0360+  DA13 71                   ld   (hl),c
0361+  DA14 23                   inc  hl
0362+  DA15 77                   ld   (hl),a
0363+  DA16 23                   inc  hl
0364+  DA17 10 F6                djnz PROHOD1
0365+  DA19 C1                   pop  bc
0366+  DA1A E1                   pop  hl
0367+  DA1B C9                   ret
0368+  DA1C             
0369+  DA1C             ;------------------------------
0370+  DA1C             /*D1LBA    defw 0,0,0
0371+  DA1C~            D2LBA    defw 0,0,0
0372+  DA1C             LEN      equ  $-32768*/
0373+  DA1C             BUFFER   ;equ  25000
0374+  DA1C 30          					block 512,48
0375+  DC1C             ;porty HOOD
0376+  DC1C             P_DAT 	equ 195	;8'b110xx011
0377+  DC1C             P_ERR 	equ 167	;8'b101xx111
0378+  DC1C             P_HSE 	equ 203	;8'b110xx011
0379+  DC1C             P_NSE 	equ 175	;8'b101xx111
0380+  DC1C             P_CYL 	equ 211	;8'b110xx011
0381+  DC1C             P_CYH 	equ 183	;8'b101xx111
0382+  DC1C             P_HEA 	equ 219	;8'b110xx011
0383+  DC1C             P_COM 	equ 191 ;8'b101xx111          
0384+  DC1C             DMA     equ  11 
0385+  DC1C             
0386+  DC1C               endmodule
1577   DC1C             MB03pluslogo
1578   DC1C             	INCBIN "MB03+LOGOv2.bin"
1579   E3FE             ultimatelogo	
1580   E3FE             	INCBIN "ULTIMATE.bin"
1581   E502             dots	
1582   E502             //	INCBIN "DOTS.bin"	
1583   E502             CaroLogo
1584   E502             	INCBIN "CaroLogo.bin"
1585   E837             EsxLogo
1586   E837             	INCBIN "ESXLOGO.bin"
1587   EDD9             BSDOSLogo
1588   EDD9             	INCBIN "BSDOSLOGO.bin"		
1589   F357             /*
1590   F357~            NewdimLogo
1591   F357~            	INCBIN "NewdimLogo.bin"
1592   F357~            eightbc_i
1593   F357~            	INCBIN "8BC_I.cde"
1594   F357~            EasyLogoSmall
1595   F357~            	INCBIN "EasyLogoSmall.bin"
1596   F357             */	
1597   F357             /*easyhdd	
1598   F357~            	INCBIN "easyhdd.out"
1599   F357             easyhddend*/
1600   F357             /*
1601   F357~            zvuk
1602   F357~            	INCBIN "ZVUK.BIN"
1603   F357~            zvukend
1604   F357             */
1605   F357             
1606   F357             /*@SP_TAB
1607   F357~            @TAB_sprite1
1608   F357~            		 DEFB 10,4
1609   F357~                     DEFW CaroLogo
1610   F357~                     DEFB 24,20
1611   F357~                     DEFW NewdimLogo
1612   F357~                     defb 0,21
1613   F357~                     defw eightbc_i
1614   F357~                     defb 1,2
1615   F357~                     defw eightbc_i
1616   F357~                     defb 25,2
1617   F357~                     defw EasyLogoSmall
1618   F357             */		 
1619   F357             ; --------------- T E X T---------------------------------------
1620   F357             TEXT0 	 	dc 16,69,"LMN128-Jan Kucera-Zlin/CZ"
1620   F357 10454C4D4E3132382D4A616E204B75636572612D5A6C696E2F43DA
1621   F372             TEXT4 		db 16,71,"1:",16,6,"MB02+(BSDOS308+EH) ",16,71,"e:",16,6,"bs128Kreset"
1621   F372 1047313A10064D4230322B284253444F533330382B454829201047653A100662
1621   F392 733132384B7265736574
1622   F39C A0          			dc " "
1623   F39D             TEXT2	 	db 16,71,"2:",16,6,"DivMMC  ",16,71,"@:",16,6,"DivIDE  "
1623   F39D 1047323A10064469764D4D4320201047403A10064469764944452020
1624   F3B9 A0          			dc " "
1625   F3BA             TEXT3    	db 16,71,"3:",16,6,"Ultimate BSDOS & esxDOS ",16,71,"d:",16,7,"Dev+ ",16,71,"t:",16,7,"diag ",16,71,"break:",16,7,"ZXROM  "
1625   F3BA 1047333A1006556C74696D617465204253444F53202620657378444F53201047
1625   F3DA 643A10074465762B201047743A100764696167201047627265616B3A10075A58
1625   F3FA 524F4D2020
1626   F3FF A0          			dc " "
1627   F400             TEXT1    	dc 16,69,"MB03+ Ultimate firmware 1.28"
1627   F400 10454D4230332B20556C74696D617465206669726D7761726520312E32B8
1628   F41E             TEXT5       db 16,71,"S:",16,7,"setup "
1628   F41E 1047533A1007736574757020
1629   F42A A0          			dc " "	
1630   F42B 10 42 20 20 STRIPS		db 16,66,32,32
1631   F42F 10 46 20 20 			db 16,70,32,32
1632   F433             			db 16,68,32,32,32,32,32
1632   F433 10442020202020
1633   F43A             			db 16,69,32,32,32,32,32
1633   F43A 10452020202020
1634   F441             			db 16,7,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32+128
1634   F441 10072020202020202020202020202020202020A0
1635   F455             ;TEXTTEST 	dc 16,6,"0123456789 128 WADHTUTTUU ZX Spectrum 128+2"
1636   F455             ;TEXTTEST2 dc 16,6,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwyxz"
1637   F455             HW1			db 16,67,"HARDWARE: "
1637   F455 104348415244574152453A20
1638   F461 1007332EB1  			dc 16,7,"3.1"
1639   F466             HW2			db 16,3,"FPGA: "
1639   F466 1003465047413A20
1640   F46E             			dc 16,7,"Xilinx SPARTAN 7 XC7S50/112 MHz"
1640   F46E 100758696C696E78205350415254414E2037205843375335302F313132204D48
1640   F48E FA
1641   F48F             HW3			db 16,3,"RTC: "
1641   F48F 10035254433A20
1642   F496             			dc 16,7,"Maxim DS3234"
1642   F496 10074D6178696D204453333233B4
1643   F4A4             HW4			db 16,3,"SRAM: ",16,7,"16MB ",16,3,"FastSRAM: ",16,7,"4MB ",16,3,"FLASH: ",16,7,"2MB  ",16,3,"FRAM: "
1643   F4A4 10035352414D3A20100731364D42201003466173745352414D3A201007344D42
1643   F4C4 201003464C4153483A201007324D42202010034652414D3A20
1644   F4DD 1007384BC2  			dc 16,7,"8KB"
1645   F4E2             HW5			db 16,3,"STORAGE: "
1645   F4E2 100353544F524147453A20
1646   F4ED             			dc 16,7,"2x microSD, CF:"
1646   F4ED 10073278206D6963726F53442C204346BA
1647   F4FE             HW6			db 16,3,"OTHERS: "
1647   F4FE 10034F54484552533A20
1648   F508             			dc 16,7,"USB, Wifi ESP8266, Matrix 8x8 LEDs"
1648   F508 10075553422C205769666920455350383236362C204D61747269782038783820
1648   F528 4C4544F3
1649   F52C             
1650   F52C             CONF1		db 16,67,"CONFIGURATION: "
1650   F52C 1043434F4E46494755524154494F4E3A20
1651   F53D 1007332EB0  			dc 16,7,"3.0"
1652   F542             CONF2		db 16,3,"3xAY: "
1652   F542 1003337841593A20
1653   F54A             			db 16,7,"ON  ",16,3,"SounDrive: ",16,7,"ON  ",16,3,"SAA1099: ",16,7,"ON  ",16,3,"Gen.Sound:"
1653   F54A 10074F4E20201003536F756E44726976653A2010074F4E202010035341413130
1653   F56A 39393A2010074F4E2020100347656E2E536F756E643A
1654   F580 10 07 4F CE 			dc 16,7,"ON"
1655   F584             CONF3		db 16,3,"DMA: "
1655   F584 1003444D413A20
1656   F58B             			db 16,7,"ON  ",16,3,"IDE: ",16,7,"ON  ",16,3,"SD: ",16,7,"ON  ",16,3,"RTC: ",16,7,"ON ",16,3,"Wifi: "
1656   F58B 10074F4E202010034944453A2010074F4E2020100353443A2010074F4E202010
1656   F5AB 035254433A2010074F4E201003576966693A20
1657   F5BE 10 07 4F CE 			dc 16,7,"ON"
1658   F5C2             CONF4		db 16,3,"DigitalVideo: "
1658   F5C2 10034469676974616C566964656F3A20
1659   F5D2 10 07 4F CE 			dc 16,7,"ON"			
1660   F5D6             ADVS0		db 16,6,"User level: " 
1660   F5D6 100655736572206C6576656C3A20
1661   F5E4 10 07 A0    			dc 16,7," "			
1662   F5E7             ADVS1		db 16,6,"OnTime: " 
1662   F5E7 10064F6E54696D653A20
1663   F5F1 10 07 A0    			dc 16,7," "
1664   F5F4             ADVS2		db 16,6,"Nmi:    "
1664   F5F4 10064E6D693A20202020
1665   F5FE 10 07 A0    			dc 16,7," "
1666   F601             ADVS3		db 16,6,"Reset:  "
1666   F601 100652657365743A2020
1667   F60B 10 07 A0    			dc 16,7," "
1668   F60E             ADVS4		db 16,6,"Extra:  "
1668   F60E 100645787472613A2020
1669   F618 10 07 A0    			dc 16,7," "
1670   F61B             ADVS5		db 16,6,"PowerUp:"
1670   F61B 1006506F77657255703A
1671   F625 10 07 A0    			dc 16,7," "
1672   F628             LEVEL0		dc 16,7,"Loser"
1672   F628 10074C6F7365F2
1673   F62F             LEVEL1		dc 16,7,"Rookie"
1673   F62F 1007526F6F6B69E5
1674   F637             LEVEL2		dc 16,6,"Novice"
1674   F637 10064E6F766963E5
1675   F63F             LEVEL3		dc 16,6,"Beginner"
1675   F63F 1006426567696E6E65F2
1676   F649             LEVEL4		dc 16,5,"Enhanced"
1676   F649 1005456E68616E6365E4
1677   F653             LEVEL5		dc 16,5,"Geek"
1677   F653 1005476565EB
1678   F659             LEVEL6		dc 16,5,"Guru"
1678   F659 1005477572F5
1679   F65F             LEVEL7		dc 16,4,"Ultimate"						
1679   F65F 1004556C74696D6174E5
1680   F669 10074657BA  FW1			dc 16,7,"FW:"
1681   F66E 312E3238AF  FW2			dc "1.28/"
1682   F673 436F7265BA  COREFW1		dc "Core:"
1683   F678 32 B0       COREFW2		dc "20"
1684   F67A             ESX1		dc 16,5,"esxDOS is loading"
1684   F67A 1005657378444F53206973206C6F6164696EE7
1685   F68D             BSD1		dc 16,5,"BSDOS+EasyHDD is loading "
1685   F68D 10054253444F532B45617379484444206973206C6F6164696E67A0
1686   F6A8             BSD2		dc 16,5,"EasyHDD is loading "
1686   F6A8 100545617379484444206973206C6F6164696E67A0
1687   F6BD             ULT1		db 16,5,"A brand new ",16,7,"BSDOS ",16,5,"is in progress of development.",32+128
1687   F6BD 100541206272616E64206E65772010074253444F53201005697320696E207072
1687   F6DD 6F6772657373206F6620646576656C6F706D656E742EA0
1688   F6F4             ULT2		db 16,6,"BUSY ",16,5,"- famous demos coder and author of BSDOS",32+128
1688   F6F4 1006425553592010052D2066616D6F75732064656D6F7320636F64657220616E
1688   F714 6420617574686F72206F66204253444F53A0
1689   F726             ULT3		dc 16,5,"for MB02+ will bring a new version soon."
1689   F726 1005666F72204D4230322B2077696C6C206272696E672061206E657720766572
1689   F746 73696F6E20736F6F6EAE
1690   F750             ULT4		db 16,6,"Miguel ",16,5,"(Papaya Dezign) is going to develop a new",32+128
1690   F750 10064D696775656C201005285061706179612044657A69676E2920697320676F
1690   F770 696E6720746F20646576656C6F702061206E6577A0
1691   F785             ULT5		db 16,7,"ESXDOS ",16,5,"ver. 0.9.x for MB03+ Ultimate with",32+128
1691   F785 1007455358444F532010057665722E20302E392E7820666F72204D4230332B20
1691   F7A5 556C74696D6174652077697468A0
1692   F7B3             ULT6		db 16,5,"lots of new features, incl. Long filename (LFN).",32+128
1692   F7B3 10056C6F7473206F66206E65772066656174757265732C20696E636C2E204C6F
1692   F7D3 6E672066696C656E616D6520284C464E292EA0
1693   F7E6             ULT7		dc 16,4,"Thanks to MB03+ capabilities both systems will be "
1693   F7E6 10045468616E6B7320746F204D4230332B206361706162696C69746965732062
1693   F806 6F74682073797374656D732077696C6C206265A0
1694   F81A             ULT8		dc 16,4,"more flexible and faster."
1694   F81A 10046D6F726520666C657869626C6520616E6420666173746572AE
1695   F835             
1696   F835             //test#3FFD   db 32
1697   F835             
1698   F835 10 00       DATE		db 16,0
1699   F837             	LUA ALLPASS
1700   F837~            	_pc('db	"' .. os.date("%Y%m%d") .. '"') 
1701   F837             db	"20200119"
1701   F837 3230323030313139
1701   F83F             	ENDLUA
1702   F83F A0          	dc " " 
1703   F840             		//block 8 // kompenzace delky souboru kvuli os.date
1704   F840             endramcode			
1705   F840             	
1706   F840             	savesna  "boot.sna",ramcode
1707   F840             	EMPTYTAP "boot.tap"
1708   F840             	SAVETAP  "boot.tap",CODE,"boot",maincode,endramcode-maincode,maincode
1709   F840             	ENDMODULE
1710   F840             		

Value    Label
------ - -----------------------------------------------------------
0x000B X boot.DMA
0x00FE   boot.ULA
0xC000   boot.maincode
0x0000 X boot.boot
0x0077   boot.endramtest
0x003A   boot.boot2
0x0026   boot.endboot
0x0038 X boot.im1
0x0042   boot.nn1
0x0058   boot.nn2
0x0077   boot.end
0x0073   boot.wait
0x0085   boot.ramcodeinrom
0xC085   boot.ramcode
0xF840   boot.endramcode
0xCDAC   boot.iinkey.IINKEY
0xC096   boot.wfon
0xC0A7   boot.wfloop1
0xC0AA   boot.wftimeout
0xC0CD   boot.wifistring
0xC0BF   boot.wfbusy
0xCD8F   boot.cls.CLS
0xC2BE   boot.skipanim
0xD7F1   boot.txy32.orflag
0xD73E   boot.txy32.T32_ATT
0xC20F   boot.fall1
0xC220   boot.fall2
0xC231   boot.fall3
0xC242   boot.fall4
0xC1CA   boot.wide1
0xCE73   boot.wait.wait
0xC2A0   boot.follow1
0xD7EB   boot.txy32.cursor
0xD73F   boot.txy32.xy
0xC27D   boot.singledot
0xC253   boot.halfdot
0xC261   boot.halfdot3
0xC26F   boot.halfdot4
0xE3FE   boot.ultimatelogo
0xD802   boot.sprite2.OK
0xDC1C   boot.MB03pluslogo
0xF42B   boot.STRIPS
0xD725   boot.txy32.txy
0xCCBD   boot.draw_jugo.DRAW
0xCF1F   boot.txy51.cursor
0xF357   boot.TEXT0
0xCE7B   boot.txy51.txy
0xF372   boot.TEXT4
0xF3BA   boot.TEXT3
0xF39D   boot.TEXT2
0xF41E   boot.TEXT5
0xF669   boot.FW1
0xF66E   boot.FW2
0xF835   boot.DATE
0xF673   boot.COREFW1
0xF678   boot.COREFW2
0xCAF9   boot.NUMBER1
0xF455   boot.HW1
0xF466   boot.HW2
0xF48F   boot.HW3
0xF4A4   boot.HW4
0xF4E2   boot.HW5
0xF4FE   boot.HW6
0xF52C   boot.CONF1
0xF542   boot.CONF2
0xF584   boot.CONF3
0xF5C2   boot.CONF4
0xD906   boot.cf.IDENT
0xC42D   boot.cferr
0xDA1C   boot.cf.BUFFER
0xDA0B   boot.cf.PROHOD
0xC45D   boot.realayinstalled
0xC497   boot.setup_tab
0xC4A6   boot.loopkey
0xCB18   boot.clock
0xC634   boot.next1
0xCC89   boot.clean
0xF6BD   boot.ULT1
0xF6F4   boot.ULT2
0xF726   boot.ULT3
0xF750   boot.ULT4
0xF785   boot.ULT5
0xF7B3   boot.ULT6
0xF7E6   boot.ULT7
0xF81A   boot.ULT8
0xC62C   boot.holdkey5
0xEDD9   boot.BSDOSLogo
0xF68D   boot.BSD1
0xC68C   boot.holdkey3
0xF6A8   boot.BSD2
0xC70A   boot.holdkey4
0xE837   boot.EsxLogo
0xF67A   boot.ESX1
0xC832   boot.holdkey1
0xC853   boot.div_erase
0xE502   boot.CaroLogo
0xF5D6   boot.ADVS0
0xF65F   boot.LEVEL7
0xC912   boot.userlevel
0xF659   boot.LEVEL6
0xF653   boot.LEVEL5
0xF649   boot.LEVEL4
0xF63F   boot.LEVEL3
0xF637   boot.LEVEL2
0xF62F   boot.LEVEL1
0xF628   boot.LEVEL0
0xF5E7   boot.ADVS1
0xD8F3   boot.xdec_06.zzbin
0xD846   boot.xdec_06.bindec
0xD8F8   boot.xdec_06.zzdec
0xCE95   boot.txy51.xy
0xF5F4   boot.ADVS2
0xF601   boot.ADVS3
0xF60E   boot.ADVS4
0xF61B   boot.ADVS5
0xCD9F   boot.iinkey.ANYKEY
0xCAA0   boot.holdkey2
0xCAD0   boot.div_erase2
0xCAE7 X boot.NUMBER4
0xCB05   boot.NUM_JED
0xCAED X boot.NUMBER3
0xCAF3 X boot.NUMBER2
0xCAFF X boot.NUMBER0
0xCB06   boot.NUM_JED1
0xCB0C   boot.NUM_PRIC
0xCC57   boot.clockbuff
0xCC6D   boot.weekdays
0xCC61   boot.clockbuff2
0xCC65   boot.clockbuff3
0xCCDC   boot.draw_jugo.LAB
0xCCF0   boot.draw_jugo.N1
0xCCFA   boot.draw_jugo.N2
0xCD3F   boot.draw_jugo.POX
0xCD63   boot.draw_jugo.LEVO
0xCD12   boot.draw_jugo.Y1
0xCD5E   boot.draw_jugo.DESNO
0xCD31   boot.draw_jugo.DIA
0xCD7B   boot.draw_jugo.GORE
0xCD1F   boot.draw_jugo.Y2
0xCD68   boot.draw_jugo.DOLE
0xCD34   boot.draw_jugo.NAST
0xCD23   boot.draw_jugo.N3
0xCD2A   boot.draw_jugo.LOOP
0xCD49   boot.draw_jugo.X1
0xCD56   boot.draw_jugo.X2
0xCDA5   boot.iinkey.ANYKEY_0
0xCDB6   boot.iinkey.II1
0xCDBA   boot.iinkey.II2
0xCDC0   boot.iinkey.II3
0xCDCF   boot.iinkey.II5
0xCDD6   boot.iinkey.II6
0xCDF8   boot.iinkey.IINN
0xCDEF   boot.iinkey.II7
0xCE4A   boot.iinkey.IISS
0xCE21   boot.iinkey.IICS
0xCDF3   boot.iinkey.II8
0xCE8D   boot.txy51.colorchange
0xCE87   boot.txy51.T42_BACK
0xCE94   boot.txy51.T42_ATT
0xCE9C X boot.txy51.xy8
0xCF25   boot.txy51.znaky
0xCEAC   boot.txy51.xy8dd
0xCEE9   boot.txy51.xyend
0xCED8   boot.txy51.xy8bb
0xCED1   boot.txy51.xy8cc
0xCF07   boot.txy51.T51_COLOR
0xCF1B   boot.txy51.flag0
0xCF05   boot.txy51.xystop
0xCF1C X boot.txy51.flag1
0xCF1D X boot.txy51.flag2
0xCF1E X boot.txy51.inp
0xCF1F X boot.txy51.xxx
0xCF20 X boot.txy51.yyy
0xCF21 X boot.txy51.leni
0xCF23 X boot.txy51.adr
0xD737   boot.txy32.colorchange
0xD731   boot.txy32.T32_BACK
0xD746 X boot.txy32.xy8
0xD756   boot.txy32.xy8dd
0xD7A3   boot.txy32.xyend
0xD7C1   boot.txy32.xy8bbnew
0xD77B   boot.txy32.xy8cc
0xD782 X boot.txy32.xy8bb
0xD7D0   boot.txy32.T32_COLOR
0xD7E7   boot.txy32.flag0
0xD7BF   boot.txy32.xystop
0xD7E8 X boot.txy32.flag1
0xD7E9 X boot.txy32.flag2
0xD7EA X boot.txy32.inp
0xD7EB X boot.txy32.xxx
0xD7EC X boot.txy32.yyy
0xD7ED X boot.txy32.leni
0xD7EF X boot.txy32.adr
0xD7F2 X boot.sprite2.SP_
0xD814   boot.sprite2.OK_SEM
0xD81F   boot.sprite2.OK_RADE1
0xD828   boot.sprite2.OK_DALSI
0xD82A   boot.sprite2.OK_RADEK
0xD846   boot.xdec_06.z
0x000A   boot.xdec_06.lldec
0xD84C   boot.xdec_06.cls1
0x0004   boot.xdec_06.llbin
0xD852   boot.xdec_06.bndc0
0xD8B9   boot.xdec_06.binx2
0xD902   boot.xdec_06.eedec
0xD85A   boot.xdec_06.bndc2
0xD863   boot.xdec_06.bndc3
0xD86B   boot.xdec_06.decbin
0xD871   boot.xdec_06.cls2
0xD87B   boot.xdec_06.dcbn0
0xD902   boot.xdec_06.zzbuf
0xD886   boot.xdec_06.dcbn1
0xD89B   boot.xdec_06.dcbn2
0xD8AC   boot.xdec_06.dcbn3
0xD8BF   boot.xdec_06.bnxx2
0xD8C5   boot.xdec_06.binneg
0xD8CB   boot.xdec_06.bnngx
0xD8D4 X boot.xdec_06.zbndec
0xD8F7   boot.xdec_06.eebin
0xD8E2   boot.xdec_06.zbn1
0xD8F7   boot.xdec_06.sign
0xD8E8 X boot.xdec_06.zdcbin
0xD8F3   boot.xdec_06.k
0x00AD X boot.xdec_06.l
0xD906 X boot.xdec_06.eebuf
0xD994   boot.cf.IDENTIFY
0xD986   boot.cf.TEXT16
0xD936   boot.cf.TISKSTATUS1
0xD938   boot.cf.TEXT11
0xD966   boot.cf.TEXT14
0xD95A   boot.cf.TEXT13
0xD948   boot.cf.TEXT12
0xD978   boot.cf.TEXT15
0xD98B X boot.cf.TEXT_YES
0xD990 X boot.cf.TEXT_NO
0xD99D   boot.cf.ACCMODE0
0xD9B0   boot.cf.TST_BSY
0x00DB   boot.cf.P_HEA
0x00BF   boot.cf.P_COM
0xD9CA   boot.cf.TST_DR
0xD9E6   boot.cf.RD_512
0xD9B4   boot.cf.TST1
0xD9C5   boot.cf.TOUT1
0xD9B9 X boot.cf.P84
0xD9DB   boot.cf.ER6
0xD9DF   boot.cf.ER3
0xD9E3   boot.cf.ER1
0xDA06   boot.cf.DMADR1
0xD9FD   boot.cf.RD1S
0x000E   boot.cf.RD1L
0x000B   boot.cf.DMA
0xD9F1 X boot.cf.RDWR1
0x00C3   boot.cf.P_DAT
0xDA0F   boot.cf.PROHOD1
0x00A7 X boot.cf.P_ERR
0x00CB X boot.cf.P_HSE
0x00AF X boot.cf.P_NSE
0x00D3 X boot.cf.P_CYL
0x00B7 X boot.cf.P_CYH
0xE502 X boot.dots
0xF400 X boot.TEXT1
